<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>jedipunkz 🚀 のブログ</title>

<meta name="description" content="Theme PaperMod - https://github.com/adityatelange/hugo-PaperMod">
<meta name="author" content="Theme PaperMod">
<link rel="canonical" href="https://jedipunkz.github.io/" />
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.6f60056d44d3f7eb69a4bc6c332b59960f3a995802bded244750232f33713c49.css" integrity="sha256-b2AFbUTT9&#43;tppLxsMytZlg86mVgCve0kR1AjLzNxPEk=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://jedipunkz.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://jedipunkz.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://jedipunkz.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://jedipunkz.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://jedipunkz.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.89.2" />
<link rel="alternate" type="application/rss+xml" href="https://jedipunkz.github.io/index.xml">
<link rel="alternate" type="application/json" href="https://jedipunkz.github.io/index.json">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript>
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-30563095-1', 'auto');
	
	ga('send', 'pageview');
}
</script><meta property="og:title" content="jedipunkz 🚀 のブログ" />
<meta property="og:description" content="Theme PaperMod - https://github.com/adityatelange/hugo-PaperMod" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://jedipunkz.github.io/" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="jedipunkz 🚀 のブログ"/>
<meta name="twitter:description" content="Theme PaperMod - https://github.com/adityatelange/hugo-PaperMod"/>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Organization",
  "name": "jedipunkz 🚀 のブログ",
  "url": "https://jedipunkz.github.io",
  "description": "Theme PaperMod - https://github.com/adityatelange/hugo-PaperMod",
  "thumbnailUrl": "https://jedipunkz.github.io/favicon.ico",
  "sameAs": [
      "http://twitter.com/jedipunkz", "https://github.com/jedipunkz"
  ]
}
</script>
</head>

<body class="list" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://jedipunkz.github.io" accesskey="h" title="jedipunkz 🚀 のブログ (Alt + H)">jedipunkz 🚀 のブログ</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="https://jedipunkz.github.io/about" title="About">
                    <span>About</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main"> 

<article class="post-entry"> 
  <header class="entry-header">
    <h2>OpenStack Grizzy で非 Virtio OS 稼働
    </h2>
  </header>
  <section class="entry-content">
    <p>こんにちは jedipunkz です。
Virtio に対応していない OS を OpenStack で稼働させることが今まで出来なかったの ですが Grizzly から非 Virtio な OS イメージが扱えるようになった。今まで NetBSD やら古い FreeBSD やら virtio ドライバを OS イメージに入れることに苦労していたの だけど、これで問題無くなった。
最初、この機能のこと調べるのに「どうせ libvirt が生成する xml を書き換えるのだ から nova 周りの設定なんだろうー」と思っていたら全く方法が見つからず…。結局 OS イメージを格納している Glance の設定にありました。
ここでは FreeBSD7.4 Release を例に挙げて説明していきます。
前提とする環境  OpenStack Grizzly が稼働していること ホスト OS に Ubuntu 12.04.2 LTS が稼働していること ゲスト OS に FreeBSD 7.4 Release を用いる  とします。OS のバージョンはホスト・ゲスト共に、上記以外でも構いません。Grizzly さえ動いていれば OK です。
OS イメージ作成 KVM で OS イメージを作成します。もちろん virtio なインターフェースは指定せず...</p>
  </section>
  <footer class="entry-footer"><span title='2013-04-21 00:00:00 +0000 UTC'>April 21, 2013</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;Theme PaperMod</footer>
  <a class="entry-link" aria-label="post link to OpenStack Grizzy で非 Virtio OS 稼働" href="https://jedipunkz.github.io/post/2013/04/21/openstack-non-virtio/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>OpenStack Grizzly 構築スクリプト
    </h2>
  </header>
  <section class="entry-content">
    <p>OpenStack Grizzly がリリースされて2週間ほど経過しました。皆さん動かしてみまし たか？今回、毎度の構築 Bash スクリプトを開発したので公開します。
下記のサイトで公開しています。
https://github.com/jedipunkz/openstack_grizzly_install
このスクリプト、複数台構成とオールインワン構成の両方が構成出来るようなっていま すが、今回は簡単なオールインワン構成の組み方をを簡単に説明したいと思います。
前提の環境  Ubuntu 12.04 LTS が稼働している Cinder のためのディスクを OS 領域と別に用意 (/dev/sdb1 など) オールインワン構成の場合は 2 NICs 準備  Ubuntu 13.04 の daily build も完成度上がっている時期ですが OVS 側の対応が OpenStack 構成に問題を生じさせるため 12.04 LTS &#43; Ubuntu Cloud Archive の組み合 わせで構築するのが主流になっているようです。また、Cinder 用のディスクは OS 領 域を保持しているディスクとは別 (もしくはパーティションを切ってディスクデバイス を別けても可) が必要です。オールインワン構成の場合は NIC を2つ用意する必要があ ります。通常 OpenStack を複数台構成する場合は
 コントローラノード x 1 台 ネットワークノード x 1 台 コンピュートノード x n 台  で組み、VM はコンピュートノードからネットワークノードを介してインターネットに 接続します。よってそのため更に NIC が必要になるのですが、オールインワン構成の 場合は...</p>
  </section>
  <footer class="entry-footer"><span title='2013-04-20 00:00:00 +0000 UTC'>April 20, 2013</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;Theme PaperMod</footer>
  <a class="entry-link" aria-label="post link to OpenStack Grizzly 構築スクリプト" href="https://jedipunkz.github.io/post/2013/04/20/openstack-grizzly-installation-script/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>Chef 11 サーバのローカルネットワーク上構築
    </h2>
  </header>
  <section class="entry-content">
    <p>chef-solo を使うの？Chef サーバを使うの？という議論は結構前からあるし、答えは 「それぞれの環境次第」だと思うのだが、僕は個人的に Chef サーバを使ってます。ホ ステッド Chef を使いたいけどお金ないし。会社で導入する時はホステッド Chef を契 約してもらうことを企んでます。(・∀・) 何故なら cookbooks を開発することがエン ジニアの仕事の本質であって Chef サーバを運用管理することは本質ではないから。そ れこそクラウド使えという話だと思う。
でも！Chef に慣れるには無料で使いたいし、継続的に Cookbooks をターゲットノード で実行したい。ということで Chef サーバを構築して使っています。
Chef 10 の時代は Chef サーバの構築方法は下記の通り3つありました。
 手作業！ Bootstrap 構築 Opscode レポジトリの Debian, Ubuntu, CentOS パッケージ構築  それが Chef 11 では
 Ubuntu, RHEL のパッケージ (パッケージインストールですべて環境が揃う)  http://www.opscode.com/chef/install/
この方法1つだけ。でも簡単になりました。
‘Chef Server’ タブを選択するとダウンロード出来る。じっくりは deb ファイルの中 身を見たことがないけど、チラ見した時に chef を deb の中で実行しているように見 えた。徹底してるｗ
Chef 10 時代のパッケージと違って行う操作は下記の2つのコマンドだけ。
% sudo dpkg -i chef-server_11....</p>
  </section>
  <footer class="entry-footer"><span title='2013-04-06 00:00:00 +0000 UTC'>April 6, 2013</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;Theme PaperMod</footer>
  <a class="entry-link" aria-label="post link to Chef 11 サーバのローカルネットワーク上構築" href="https://jedipunkz.github.io/post/2013/04/06/chef-11-private-network/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>クラウドマネジメント勉強会レポ
    </h2>
  </header>
  <section class="entry-content">
    <p>クラウドマネジメント勉強会に参加してきた。今が旬なのか定員140名が埋まっていま した。クラウドフェデレーションサービス各種の話が聞ける貴重な勉強会の場でした。
場所 : スクエアエニックスさん 日程 : 2013年4月5日 19:00 -  少し長くなるので、早速。
クラウド運用管理研究会 クラウド利用推進機構が運営するクラウド運用管理研究会は下記の3つに分別されるそ うです。今回は一項目の ‘クラウドマネジメントツール研究会’ にあたるそう。別の研 究会も既に勉強会を実施しているそうです。
 クラウドマネジメントツール研究会 デザインパターン研究会 運用管理・監視研究会  AWS OpsWorks アマゾンデータサービスジャパン AWS 片山さん, 船崎さん  OpsWorks は最近話題になった AWS 利用者に無料で提供されるクラウドフェデレーショ ンサービス。Web UI で操作し簡単デプロイを実現するサービスです。
OpsWorks が自動化するモノ  サーバ設定 ミドルウェア構築  特徴  Chef フレームワークを利用 (chef-solo を内部的に利用) 任意の cookbooks を利用可能 LB, AP, DB などをレイヤ化, 任意のレイヤも作成可能  OpsWorks の流れ  Stack 作成 レイヤ作成 (LB, AP, DB, 任意) レシピの作成 レイヤにインスタンス作成  下記をレイヤ化で区別する  Package インストール OS 設定 アプリデプロイ  所感 AWS OpsWorks の登場で他のクラウドフェデレーションサービスがどうなるの？とさえ 思った。AWS はインターネット・ホスティング業界のあらゆるサービスを押さえようと している感がある。もう隙間がない！ｗ OpsWorks に関してまだ問題は残っているそう だ。VPC, micro 現在未対応など。が解決に向けて作業しているそう。...</p>
  </section>
  <footer class="entry-footer"><span title='2013-04-06 00:00:00 +0000 UTC'>April 6, 2013</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;Theme PaperMod</footer>
  <a class="entry-link" aria-label="post link to クラウドマネジメント勉強会レポ" href="https://jedipunkz.github.io/post/2013/04/06/cloudmanagement/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>NetBSD on OpenStack
    </h2>
  </header>
  <section class="entry-content">
    <p>もう数日で OpenStack の次期バージョン版 Grizzly がリリースされるタイミングだが 現行バージョン Folsom の OpenStack の上に NetBSD を載せてみた。完全にお遊び だけど…。
結局、ほとんど何も特別な対応取ることなく NetBSD が動いた。もちろんハイパーバイ ザは KVM です。だけど少し条件がある。
qemu の不具合があり Ubuntu 12.04 LTS &#43; Ubuntu Cloud Archives の組み合わせでは NetBSD が動作しなかった。下記のようなカーネルパニックが発生。
panic: pci_make_tag: bad request  この不具合に相当するんじゃないかと思ってる。
https://bugs.launchpad.net/qemu/&#43;bug/897771
よって下記の組み合わせで動作を確認した。
 Ubuntu 12.10 &#43; OpenStack (Native Packages) qemu, kvm : 1.2.0&#43;noroms-0ubuntu2.12.10.3 NetBSD 6.1 RC2 amd64  前提条件 OpenStack Folsom が動作していること。
NetBSD OS イメージ作成 nova-compute が動作しているホストの qemu-kvm を利用する。OpenStack 上に何でも 良いので OS を動作させこの kvm プロセスのパラメータを参考に kvm コマンドを実行 し NetBSD をインストールさせた。一番確実な方法。...</p>
  </section>
  <footer class="entry-footer"><span title='2013-03-28 00:00:00 +0000 UTC'>March 28, 2013</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;Theme PaperMod</footer>
  <a class="entry-link" aria-label="post link to NetBSD on OpenStack" href="https://jedipunkz.github.io/post/2013/03/28/netbsd-on-openstack/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>Berkshelf で Chef Cookbook の管理
    </h2>
  </header>
  <section class="entry-content">
    <p>こんにちは。@jedipunkz です。
今日は Chef Cookbook の管理をしてくれる Berkshelf について。
Berkshelf は Librarian-Chef と同じく Cookbook の管理をしてくれるツールです。依 存関係のクリアもしてくれます。Opscode の中の人 @someara さんにこんなこと言われ て、
@jedipunkz berkshelf &gt; librarian-chef
— somearaさん (@someara) 2013年2月5日   Librarian-chef じゃなくて Berkshelf 使えってことだろうなぁと思ったので僕は Bekshelf を使うようにしてます。先日ブログ記事にした openstack-chef-repo も以前 は Librarian-chef を使っていたのですが最近 Berkshelf に置き換わりました。 openstack-chef-repo は Opscode の中の人の @mattray さん達が管理しています。
では早速。
インストール インストールは簡単。gem install するだけです。
% gem install berkshelf  使い方 chef-repo 配下で Berksfile を下記のように書きます。
site :opscode cookbook &#39;chef-client&#39; cookbook &#39;nginx&#39;, &#39;= 0....</p>
  </section>
  <footer class="entry-footer"><span title='2013-03-17 00:00:00 +0000 UTC'>March 17, 2013</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;Theme PaperMod</footer>
  <a class="entry-link" aria-label="post link to Berkshelf で Chef Cookbook の管理" href="https://jedipunkz.github.io/post/2013/03/17/berkshelf-chef-cookbook-manage/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>chef-client の継続的デリバリ
    </h2>
  </header>
  <section class="entry-content">
    <p>こんにちは。@jedipunkz です。
久々に Chef の話題。
有名な方々が最近 Chef について記事書いたりで Chef が再び盛り上がってきましたね。 僕のブログにも chef-solo で検索してアクセスしてくる方が増えているようです。
ちょうど今、仕事で試験的なサービスを立ち上げてそこで Chef を使っているのですが Server, Workstation, Target Node(s) の構成で使っていて、僕らは最初から chef-solo と capistrano でってことは考えていませんでした。もちろん chef-solo &#43; capistrano の環境も調査しましたが、今の Server 構成が便利なのでもう戻れない。
今日は Chef サーバ構成の良さについての記事ではないですが、それについては次回、 時間見つけて書こうかと思ってます。
今日は ‘chef-client をどうアップデートするか’ について。せっかく Chef でサーバ構成を継続的にデプロイ出来ても Chef 自身をアップデート出来ないと悲しい ですよね。chef-client が稼働しているインスタンスなんて起動して利用してすぐに破 棄だって時代ですが、なかなかそうもいなかい気がしています。
「ほら、だから chef-solo 使えばいいんだよ！」って思ってるあなた！違うんですよー。 そのデメリットを上回るメリットが Chef サーバ構成にあるんです。次回書きますｗ
Chef10 から Chef11 と試験してみるにはちょうど良い時期でした。今回の構成は…
旧環境 &#43;------------------&#43; | chef server | | version 10.18 | &#43;------------------&#43; ^ | &#43;--------------------&#43; | | | | &#43;------------------&#43; &#43;------------------&#43; | chef workstation | | target node | | version 10....</p>
  </section>
  <footer class="entry-footer"><span title='2013-03-15 00:00:00 +0000 UTC'>March 15, 2013</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;Theme PaperMod</footer>
  <a class="entry-link" aria-label="post link to chef-client の継続的デリバリ" href="https://jedipunkz.github.io/post/2013/03/15/chef-contenuously-deploy/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>pry のススメ
    </h2>
  </header>
  <section class="entry-content">
    <p>OpenStack をコードで管理するためのフレームワークは幾つか存在するのだけど Ruby で記述出来る Fog が良い！と隣に座ってるアプリエンジニアが言うので僕も最近少し 触ってます。
Fog を使った OpenStack を管理するコードを書くことも大事なのだけど、Fog のコン トリビュートってことで幾つかの機能を付け足して (Quantum Router 周り) ってこと をやってました。まだ取り込まれてないけど。
その開発の中で pry の存在を教えてもらいその便利さに驚いたので少し説明します。 バリバリ開発系の人は既に知っているだろうけど、インフラ系エンジニアの僕にとって は感激モノでした。
pry は irb 代替な Ruby のインタラクティブシェルです。下記の URL から持ってこれ ます。
https://github.com/pry/pry
シンタックスハイライトされたり json のレスポンスが綺麗に成形されたり irb 的に 使うだけでも便利なのだけど ‘?’ や ‘$’ でコードのシンタックスを確認したりコード 内容を確認したり出来るのがアツい！
ちょうど今回追加した Fog の機能を使って説明していみます。
Fog のコードを require して OpenStack に接続するための情報を設定し OpenStack Quantum に接続します。これで準備完了。
[38] pry(main)&gt; require &#39;/home/jedipunkz/fog/lib/fog.rb&#39; [49] pry(main)&gt; @connection_hash = { [49] pry(main)* :openstack_username =&gt; &#39;demo&#39;, [49] pry(main)* :openstack_api_key =&gt; &#39;demo&#39;, [49] pry(main)* :openstack_tenant =&gt; &#39;service&#39;, [49] pry(main)* :openstack_auth_url =&gt; &#39;http://172....</p>
  </section>
  <footer class="entry-footer"><span title='2013-03-06 00:00:00 +0000 UTC'>March 6, 2013</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;Theme PaperMod</footer>
  <a class="entry-link" aria-label="post link to pry のススメ" href="https://jedipunkz.github.io/post/2013/03/06/pry/"></a>
</article>
<footer class="page-footer">
  <nav class="pagination">
    <a class="prev" href="https://jedipunkz.github.io/page/11/">« Prev Page</a>
    <a class="next" href="https://jedipunkz.github.io/page/13/">Next Page »</a>
  </nav>
</footer>
    </main>
    
<footer class="footer">
    <span>&copy; 2021 <a href="https://jedipunkz.github.io">jedipunkz 🚀 のブログ</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
