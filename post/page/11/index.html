<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Posts | jedipunkz 🚀 のブログ</title>

<meta name="keywords" content="" />
<meta name="description" content="Theme PaperMod - https://github.com/adityatelange/hugo-PaperMod">
<meta name="author" content="Theme PaperMod">
<link rel="canonical" href="https://jedipunkz.github.io/post/" />
<link href="https://jedipunkz.github.io/assets/css/stylesheet.min.c67f61ce2add05cf1690a03e10f394ed97d680c36fc4d7e53203318142a5ab6c.css" integrity="sha256-xn9hzirdBc8WkKA&#43;EPOU7ZfWgMNvxNflMgMxgUKlq2w=" rel="preload stylesheet"
    as="style">

<link rel="icon" href="https://jedipunkz.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://jedipunkz.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://jedipunkz.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://jedipunkz.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://jedipunkz.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.79.1" />
<link rel="alternate" type="application/rss&#43;xml" href="https://jedipunkz.github.io/post/index.xml">


<meta property="og:title" content="Posts" />
<meta property="og:description" content="Theme PaperMod - https://github.com/adityatelange/hugo-PaperMod" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://jedipunkz.github.io/post/" />
<meta property="og:updated_time" content="2020-12-27T00:49:51+09:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Posts"/>
<meta name="twitter:description" content="Theme PaperMod - https://github.com/adityatelange/hugo-PaperMod"/>



</head>

<body class="list" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    }

</script>
<noscript>
    <style type="text/css">
        .theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript>
<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://jedipunkz.github.io" accesskey="h" title="jedipunkz 🚀 のブログ (Alt + H)">jedipunkz 🚀 のブログ</a>
            <span class="logo-switches">
                <span class="theme-toggle" title="(Alt + T)">
                    <a id="theme-toggle" accesskey="t">
                        <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                            fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                            stroke-linejoin="round">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                        </svg>
                        <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                            fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                            stroke-linejoin="round">
                            <circle cx="12" cy="12" r="5"></circle>
                            <line x1="12" y1="1" x2="12" y2="3"></line>
                            <line x1="12" y1="21" x2="12" y2="23"></line>
                            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                            <line x1="1" y1="12" x2="3" y2="12"></line>
                            <line x1="21" y1="12" x2="23" y2="12"></line>
                            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                        </svg>
                    </a>
                </span>
                
            </span>
        </div>
        <ul class="menu" id="menu" onscroll="menu_on_scroll()">
            <li>
                <a href="https://jedipunkz.github.io/about" title="About">
                    <span>About</span>
                </a>
            </li></ul>
    </nav>
</header>

    <main class="main"> 
<header class="page-header">
  <h1>Posts</h1>
</header>



<article class="post-entry"> 

  <header class="entry-header">
    <h2>
      OpenStack &#43; Ceph 連携
    </h2>
  </header>
  <section class="entry-content">
    <p>こんにちは。最近 OpenStack の導入に向けて保守性や可用性について調査している @jedipunkzです。
OpenStack は MySQL のダンプや OS イメージ・スナップショットのバックアップをとっ ておけばコントローラの復旧も出来ますし、Grizzly 版の Quantum では冗長や分散が 取れるので障害時に耐えられます。また Quantum の復旧は手動もで可能です。最後の 悩みだった Cinder の接続先ストレージですが、OpenStack のスタンスとしては高価な ストレージの機能を使ってバックアップ取るか、Ceph, SheepDog のようなオープンソー スを使うか、でした。で、今回は Ceph を OpenStack に連携させようと思いました。
この作業により Cinder の接続先ストレージが Ceph になるのと Glance の OS イメー ジ・スナップショットの保管先が Ceph になります。
下記の参考資料が完成度高く、ほぼ内容はそのままです。若干付け足していますが。
参考資料 http://ceph.com/docs/master/rbd/rbd-openstack/
前提の構成 &#43;-------------&#43;-------------&#43;--------------------------------------------- Public/API Network | | | &#43;-----------&#43; &#43;-----------&#43; &#43;-----------&#43; &#43;-----------&#43; &#43;-----------&#43; &#43;-----------&#43; | | | | |vm|vm|.. | | | | | | | | controller| | network | &#43;-----------&#43; | ceph01 | | ceph01 | | ceph01 | | | | | | compute | | | | | | | | | | | | | | | | | | | &#43;-----------&#43; &#43;-----------&#43; &#43;-----------&#43; &#43;-----------&#43; &#43;-----------&#43; &#43;-----------&#43; | | | | | | | | &#43;-------------&#43;-----)-------&#43;-----)-------&#43;-------------&#43;-------------&#43;-- Management/API Network | | &#43;-------------&#43;-----------------------------------&#43;-- Data Network   Ceph は OpenStack の Management Network 上に配置 Ceph は3台構成 (何台でも可) OpenStack も3台構成 (何台でも可) 連携処理するのは controller, compute ノード  では早速手順ですが、OpenStack と Ceph の構築手順は割愛します。私の他の記事を参 考にしていただければと思います。...</p>
  </section>
  <footer class="entry-footer">

May 19, 2013&nbsp;·&nbsp;3 min&nbsp;·&nbsp;Theme PaperMod
</footer>
  <a class="entry-link" aria-label="post link to OpenStack &#43; Ceph 連携" href="https://jedipunkz.github.io/post/2013/05/19/openstack-ceph/"></a>
</article>
<article class="post-entry"> 

  <header class="entry-header">
    <h2>
      Chef Cookbook でユーザ・グループ追加
    </h2>
  </header>
  <section class="entry-content">
    <p>こんにちは。@jedipunkzです。 今回は Opscode Chef でユーザ・グループを作成する方法をまとめます。
‘users’ Cookbook を使います。
% cd ${YOUR_CHEF_REPO} % ${EDITOR} Berksfile cookbook &#39;users&#39; % berks install --path ./cookbooks  data_bag を使ってユーザ・グループの管理をしたいので管理ディレクトリを作成しま す。
% mkdir -p data_bags/users  data_bags/users/jedipunkz.json ファイルを作成します。必要に応じて内容を書き換えてください。
{ &#34;id&#34;: &#34;jedipunkz&#34;, &#34;ssh_keys&#34;: &#34;ssh-rsa AAAABx92tstses jedipunkz@somewhere&#34;, &#34;groups&#34;: [ &#34;sysadmin&#34;, &#34;sudo&#34; ], &#34;uid&#34;: 2001, &#34;shell&#34;: &#34;\/usr\/bin\/zsh&#34;, &#34;comment&#34;: &#34;jedipunkz sysadmin&#34;, &#34;password&#34;: &#34;$1$s%H8BMHlB$7s3h30y9IB1SklftZXYhvssJ&#34; }  json ファイルの説明です。
 id : ユーザ名 ssh_keys : SSH 公開鍵 groups : 所属させるグループ uid : unix id sheell : ログインシェル comment : コメント passwd : ハッシュ化したパスワード  特にハッシュ化したパスワードは下記のコマンドで生成出来ます。...</p>
  </section>
  <footer class="entry-footer">

May 18, 2013&nbsp;·&nbsp;1 min&nbsp;·&nbsp;Theme PaperMod
</footer>
  <a class="entry-link" aria-label="post link to Chef Cookbook でユーザ・グループ追加" href="https://jedipunkz.github.io/post/2013/05/18/chef-cookbook-adding-users/"></a>
</article>
<article class="post-entry"> 

  <header class="entry-header">
    <h2>
      Ceph-Deploy で Ceph 分散ストレージ構築
    </h2>
  </header>
  <section class="entry-content">
    <p>今回は ceph-deploy というツールを使って Ceph ストレージを簡単に構築することが 出来るので紹介します。Ceph は分散ストレージでオブジェクトストレージとしてもブ ロックストレージとしても動作します。今回の構築ではブロックストレージとしてのみ の動作です。
Ceph が公開しているのが ceph-deploy なわけですが、マニュアル操作に代わる構築方 法として公開しているようです。その他にも Chef Cookbook も公開されているようで す。
それでは早速。
今回の構成 &#43;--------&#43; &#43;--------&#43; &#43;--------&#43; | ceph01 | | ceph02 | | ceph03 | | osd | | osd | | osd | | mon | | mon | | mon | | mds | | mds | | mds | &#43;--------&#43; &#43;--------&#43; &#43;--------&#43; | 10.0.0.1 | 10.0.0.2 | 10.0.0.3 | | | &#43;----------&#43;----------&#43; | | 10....</p>
  </section>
  <footer class="entry-footer">

May 11, 2013&nbsp;·&nbsp;3 min&nbsp;·&nbsp;Theme PaperMod
</footer>
  <a class="entry-link" aria-label="post link to Ceph-Deploy で Ceph 分散ストレージ構築" href="https://jedipunkz.github.io/post/2013/05/11/ceph-deploy/"></a>
</article>
<article class="post-entry"> 

  <header class="entry-header">
    <h2>
      Quantum Network ノードの分散・冗長
    </h2>
  </header>
  <section class="entry-content">
    <p>こんにちは。Grizzly がリリースされてから暫く経ちました。今回は Folsom リリース まであった Quantum ノードのボトルネックと単一障害点を解決する新しい機能につい て評価した結果をお伝えします。
Folsom までは
 Quantum L3-agent が落ちると、その OpenStack 一式の上にある仮想マシン全ての通 信が途絶える Quantum L3-agent に仮想マシンの全てのトラフィックが集まりボトルネックとなる。  という問題がありました。Folsom リリース時代にもし僕が職場で OpenStack を導入す るのであればこれらを理由に nova-network を選択していたかもしれません。 nova-network は compute ノードが落ちればその上の仮想マシンも同時に落ちるが、他 の compute ノード上の仮想マシンの通信には影響を与えないからです。もちろん仮想 ルータ・仮想ネットワークの生成等を API でユーザに提供したいなどの要望があれば Quantum を選択するしかありませんが。これに対して Grizzly リリースの Quantum は 改善に向けて大きな機能を提供してくれています。L3-agent, DHCP-agent の分散・冗 長機能です。
下記の構成が想定出来ます。ここでは Network ノードを2台用意しました。それ以上の 台数に増やすことも出来ます。
&#43;-------------&#43;-------------&#43;-------------------------- Public/API Network | | | &#43;-----------&#43; &#43;-----------&#43; &#43;-----------&#43; &#43;-----------&#43; | | | | | | |vm|vm|.. | | controller| | network | | network | &#43;-----------&#43; | | | | | | | compute | &#43;-----------&#43; &#43;-----------&#43; &#43;-----------&#43; &#43;-----------&#43; | | | | | | | &#43;-------------&#43;-----)-------&#43;-----)-------&#43;-----)------ Management/API Network | | | &#43;-------------&#43;-------------&#43;------ Data Network  L3-agent の分散は仮想ルータ単位で行います。それに対し DHCP-agent は仮想 ネットワーク単位で行います。...</p>
  </section>
  <footer class="entry-footer">

April 26, 2013&nbsp;·&nbsp;3 min&nbsp;·&nbsp;Theme PaperMod
</footer>
  <a class="entry-link" aria-label="post link to Quantum Network ノードの分散・冗長" href="https://jedipunkz.github.io/post/2013/04/26/quantum-network-distributing/"></a>
</article>
<article class="post-entry"> 

  <header class="entry-header">
    <h2>
      Chef for OpenStack
    </h2>
  </header>
  <section class="entry-content">
    <p>以前にも話題にしたことがある Chef For OpenStack ですが今週新しい情報が入って来 ました。#ChefConf 2013 というイベントがあったのですがここで Opscode の Matt Ray さんらが集まり OpenStack を Chef で構築する ‘Chef for OpenStack’ について 語られた模様です。その時の資料が SlideShare に上がっていたので見てみました。
気にあった点を幾つか挙げていきます。
 https://github.com/osops で管理される 各コンポーネントの cookbook の名前には ‘-cookbook’ を最後に付ける quantum, cinder, ceilometer, heat 等、比較的新しいコンポーネントも加わる gerrit でコードレビューされ CI も提供される Chef11 が用いられる Ruby 1.9.x に対応した chef-client が用いられる Foodcritic で可能な限りテストされる chef-solo はサポートされない 5月に ‘2013.1.0’ がリリースされる (openstack 2013.1 対応と思われる) chef-repo の形で提供される Ubuntu 12.04 が前提 HyperVisor は KVM, LXC がサポートされる  以上です。恐らく chef-repo で提供されるということは spiceweasel を使った構成構 築が出来るような形になるでしょう。楽しみです。またコントリビュートする方法も掲 載されているので興味が有る方は協力してみるのも楽しいかもしれません。...</p>
  </section>
  <footer class="entry-footer">

April 21, 2013&nbsp;·&nbsp;1 min&nbsp;·&nbsp;Theme PaperMod
</footer>
  <a class="entry-link" aria-label="post link to Chef for OpenStack" href="https://jedipunkz.github.io/post/2013/04/21/chef-for-openstack-grizzly-roadmap/"></a>
</article>
<article class="post-entry"> 

  <header class="entry-header">
    <h2>
      OpenStack Grizzy で非 Virtio OS 稼働
    </h2>
  </header>
  <section class="entry-content">
    <p>こんにちは jedipunkz です。
Virtio に対応していない OS を OpenStack で稼働させることが今まで出来なかったの ですが Grizzly から非 Virtio な OS イメージが扱えるようになった。今まで NetBSD やら古い FreeBSD やら virtio ドライバを OS イメージに入れることに苦労していたの だけど、これで問題無くなった。
最初、この機能のこと調べるのに「どうせ libvirt が生成する xml を書き換えるのだ から nova 周りの設定なんだろうー」と思っていたら全く方法が見つからず…。結局 OS イメージを格納している Glance の設定にありました。
ここでは FreeBSD7.4 Release を例に挙げて説明していきます。
前提とする環境  OpenStack Grizzly が稼働していること ホスト OS に Ubuntu 12.04.2 LTS が稼働していること ゲスト OS に FreeBSD 7.4 Release を用いる  とします。OS のバージョンはホスト・ゲスト共に、上記以外でも構いません。Grizzly さえ動いていれば OK です。
OS イメージ作成 KVM で OS イメージを作成します。もちろん virtio なインターフェースは指定せず...</p>
  </section>
  <footer class="entry-footer">

April 21, 2013&nbsp;·&nbsp;1 min&nbsp;·&nbsp;Theme PaperMod
</footer>
  <a class="entry-link" aria-label="post link to OpenStack Grizzy で非 Virtio OS 稼働" href="https://jedipunkz.github.io/post/2013/04/21/openstack-non-virtio/"></a>
</article>
<article class="post-entry"> 

  <header class="entry-header">
    <h2>
      OpenStack Grizzly 構築スクリプト
    </h2>
  </header>
  <section class="entry-content">
    <p>OpenStack Grizzly がリリースされて2週間ほど経過しました。皆さん動かしてみまし たか？今回、毎度の構築 Bash スクリプトを開発したので公開します。
下記のサイトで公開しています。
https://github.com/jedipunkz/openstack_grizzly_install
このスクリプト、複数台構成とオールインワン構成の両方が構成出来るようなっていま すが、今回は簡単なオールインワン構成の組み方をを簡単に説明したいと思います。
前提の環境  Ubuntu 12.04 LTS が稼働している Cinder のためのディスクを OS 領域と別に用意 (/dev/sdb1 など) オールインワン構成の場合は 2 NICs 準備  Ubuntu 13.04 の daily build も完成度上がっている時期ですが OVS 側の対応が OpenStack 構成に問題を生じさせるため 12.04 LTS &#43; Ubuntu Cloud Archive の組み合 わせで構築するのが主流になっているようです。また、Cinder 用のディスクは OS 領 域を保持しているディスクとは別 (もしくはパーティションを切ってディスクデバイス を別けても可) が必要です。オールインワン構成の場合は NIC を2つ用意する必要があ ります。通常 OpenStack を複数台構成する場合は
 コントローラノード x 1 台 ネットワークノード x 1 台 コンピュートノード x n 台  で組み、VM はコンピュートノードからネットワークノードを介してインターネットに 接続します。よってそのため更に NIC が必要になるのですが、オールインワン構成の 場合は...</p>
  </section>
  <footer class="entry-footer">

April 20, 2013&nbsp;·&nbsp;2 min&nbsp;·&nbsp;Theme PaperMod
</footer>
  <a class="entry-link" aria-label="post link to OpenStack Grizzly 構築スクリプト" href="https://jedipunkz.github.io/post/2013/04/20/openstack-grizzly-installation-script/"></a>
</article>
<article class="post-entry"> 

  <header class="entry-header">
    <h2>
      Chef 11 サーバのローカルネットワーク上構築
    </h2>
  </header>
  <section class="entry-content">
    <p>chef-solo を使うの？Chef サーバを使うの？という議論は結構前からあるし、答えは 「それぞれの環境次第」だと思うのだが、僕は個人的に Chef サーバを使ってます。ホ ステッド Chef を使いたいけどお金ないし。会社で導入する時はホステッド Chef を契 約してもらうことを企んでます。(・∀・) 何故なら cookbooks を開発することがエン ジニアの仕事の本質であって Chef サーバを運用管理することは本質ではないから。そ れこそクラウド使えという話だと思う。
でも！Chef に慣れるには無料で使いたいし、継続的に Cookbooks をターゲットノード で実行したい。ということで Chef サーバを構築して使っています。
Chef 10 の時代は Chef サーバの構築方法は下記の通り3つありました。
 手作業！ Bootstrap 構築 Opscode レポジトリの Debian, Ubuntu, CentOS パッケージ構築  それが Chef 11 では
 Ubuntu, RHEL のパッケージ (パッケージインストールですべて環境が揃う)  http://www.opscode.com/chef/install/
この方法1つだけ。でも簡単になりました。
‘Chef Server’ タブを選択するとダウンロード出来る。じっくりは deb ファイルの中 身を見たことがないけど、チラ見した時に chef を deb の中で実行しているように見 えた。徹底してるｗ
Chef 10 時代のパッケージと違って行う操作は下記の2つのコマンドだけ。
% sudo dpkg -i chef-server_11....</p>
  </section>
  <footer class="entry-footer">

April 6, 2013&nbsp;·&nbsp;1 min&nbsp;·&nbsp;Theme PaperMod
</footer>
  <a class="entry-link" aria-label="post link to Chef 11 サーバのローカルネットワーク上構築" href="https://jedipunkz.github.io/post/2013/04/06/chef-11-private-network/"></a>
</article>
<footer class="page-footer">
  <nav class="pagination">
    <a class="prev" href="https://jedipunkz.github.io/post/page/10/">« Prev Page</a>
    <a class="next" href="https://jedipunkz.github.io/post/page/12/">Next Page »</a>
  </nav>
</footer>

    </main><footer class="footer">
    <span>&copy; 2020 <a href="https://jedipunkz.github.io">jedipunkz 🚀 のブログ</a></span>
    <span>&middot;</span>
    <span>Powered by <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a></span>
    <span>&middot;</span>
    <span>Theme <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a></span>
</footer>
<a href="#top">
    <button class="top-link" id="top-link" type="button" aria-label="go to top" title="Go to Top (Alt + G)"
        accesskey="g">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6">
            <path d="M12 6H0l6-6z" />
        </svg>
    </button>
</a>



<script defer src="https://jedipunkz.github.io/assets/js/highlight.min.27cd435cc9ed6abb4b496581b151804f79f366c412620272bb94e2f5f598ebcc.js" integrity="sha256-J81DXMntartLSWWBsVGAT3nzZsQSYgJyu5Ti9fWY68w="
    onload="hljs.initHighlightingOnLoad();"></script>
<script>
    window.onload = function () {
        if (localStorage.getItem("menu-scroll-position")) {
            document.getElementById('menu').scrollLeft = localStorage.getItem("menu-scroll-position");
        }
    }
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                behavior: "smooth"
            });
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.replaceState(null, null, `#${id}`);
            }
        });
    });
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

    function menu_on_scroll() {
        localStorage.setItem("menu-scroll-position", document.getElementById('menu').scrollLeft);
    }

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>

</body>

</html>
