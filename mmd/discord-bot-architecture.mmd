%%{
  init: {
    'theme': 'base',
    'themeVariables': {
      'darkMode': true,
      'background': '#1a1b26',
      'primaryColor': '#7aa2f7',
      'lineColor': '#c0caf5',
      'textColor': '#c0caf5',
      'edgeLabelBackground': '#16161e'
    }
  }
}%%
flowchart TD
    %% Nodes
    DISCORD["Discord API"]
    EXP["Prometheus Exporter<br>discord-exporter"]
    PROM["Prometheus Server"]
    BOT["Discord Bot<br>Go Application"]
    GRAF["Grafana"]
    DUCK["DuckDB"]

    %% Styles (Tokyonight Palette)
    %% Blue: #7aa2f7, Red: #f7768e, Yellow: #e0af68, Green: #9ece6a, Purple: #bb9af7, Cyan: #7dcfff
    %% Dark text on bright backgrounds: #15161e

    classDef blue fill:#7aa2f7,stroke:#3d59a1,color:#15161e,stroke-width:2px
    classDef red fill:#f7768e,stroke:#db4b4b,color:#15161e,stroke-width:2px
    classDef yellow fill:#e0af68,stroke:#ff9e64,color:#15161e,stroke-width:2px
    classDef green fill:#9ece6a,stroke:#73daca,color:#15161e,stroke-width:2px
    classDef purple fill:#bb9af7,stroke:#9d7cd8,color:#15161e,stroke-width:2px
    classDef cyan fill:#7dcfff,stroke:#2ac3de,color:#15161e,stroke-width:2px

    %% Apply Styles
    class DISCORD blue
    class EXP red
    class PROM yellow
    class BOT green
    class GRAF purple
    class DUCK cyan

    %% Connections
    DISCORD -->|"API Calls<br>Server Stats"| EXP
    DISCORD ---|"Bot Commands"| BOT
    %% linkStyle 1 is for DISCORD --- BOT
    linkStyle 1 stroke-width:2px,fill:none,stroke:#c0caf5

    EXP -->|"Metrics Export<br>HTTP :2112"| PROM

    BOT -->|"padawan command<br>Request Graph"| GRAF
    GRAF -->|"PNG Image<br>Response"| BOT

    GRAF -->|"Data Source<br>Query API"| PROM

    BOT -->|"Structured Logs<br>JSON Format"| DUCK

    %% Link Styles (Tokyonight Foreground for lines: #c0caf5, Text color explicitly set)
    linkStyle default stroke:#c0caf5,stroke-width:2px,color:#c0caf5
