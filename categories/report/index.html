


    
        
    




<!DOCTYPE HTML>

<html>
    <head>
        
            <title>Report Posts - ジェダイさんのブログ</title>
        

        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="generator" content="Hugo 0.53" />
        


        
        
            
        

        <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Report"/>
<meta name="twitter:description" content=""/>

        <meta property="og:title" content="Report" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://jedipunkz.github.io/categories/report/" />
<meta property="og:updated_time" content="2014-06-22T00:00:00&#43;00:00"/>

        
<meta itemprop="name" content="Report">
<meta itemprop="description" content="">


        

        

        
        
            
        

        
        
            <link rel="stylesheet" href="/css/google-font.css" />
            <link rel="stylesheet" href="/css/font-awesome.min.css" />
            <link rel="stylesheet" href="/css/main.css" />
            <link rel="stylesheet" href="/css/add-on.css" />
            <link rel="stylesheet" href="/css/monokai-sublime.css">
        

        

        
        
        
            
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-30563095-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

        
    </head>
    <body>

        
        <div id="wrapper">

    
<header id="header">
    
        <h2><a href="/"></i></a></h2>
    

    <nav class="links">
        <ul>
            
                <li>
                    <a href="">
                        Blog
                    </a>
                </li>
            
                <li>
                    <a href="about/index.html">
                        About
                    </a>
                </li>
            
        </ul>
    </nav>
    <nav class="main">
        <ul>
            
            <li class="search">
                <a class="fa-search" href="#search">Search</a>
                <form id="search" method="get" action="//google.com/search">
                    <input type="text" name="q" placeholder="Search" />
                    <input type="hidden" name="q" value="site:https://jedipunkz.github.io">
                </form>
            </li>
            <li class="menu">
                <a class="fa-bars" href="#menu">Menu</a>
            </li>
        </ul>
    </nav>
</header>


<section id="menu">

    
        <section>
            <form class="search" method="get" action="//google.com/search">
                <input type="text" name="q" placeholder="Search" />
                <input type="hidden" name="q" value="site:https://jedipunkz.github.io">
            </form>
        </section>

    
        <section>
            <ul class="links">
                
                    <li>
                        <a href="">
                            <h3>
                                
                                Blog
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="about/index.html">
                            <h3>
                                
                                About
                            </h3>
                        </a>
                    </li>
                
            </ul>
        </section>

    
        <section>
            <ul class="links">
                <header>
                    <h3>Recent Posts</h3>
                </header>
                
                    
                

                
                    <li>
                        <a href="https://jedipunkz.github.io/blog/2018/12/31/istio/"><p>Istio, Helm を使って Getting Started 的なアプリをデプロイ</p></a>
                    </li>
                
                    <li>
                        <a href="https://jedipunkz.github.io/blog/2017/07/02/test-kitchen-cluster/"><p>Docker,Test-Kitchen,Ansible でクラスタを構成する</p></a>
                    </li>
                
                    <li>
                        <a href="https://jedipunkz.github.io/blog/2017/04/13/gke-lb/"><p>GCP ロードバランサと GKE クラスタを Terraform を使って構築する</p></a>
                    </li>
                
                    <li>
                        <a href="https://jedipunkz.github.io/blog/2017/02/12/serverless-fission/"><p>Serverless on Kubernetes : Fission を使ってみた</p></a>
                    </li>
                
                    <li>
                        <a href="https://jedipunkz.github.io/blog/2017/01/13/kubernetes-deployments/"><p>Kubernetes Deployments を使ってみた！</p></a>
                    </li>
                
            </ul>
        </section>

    
        
</section>

    
    <div id="main">
        <h1>Report</h1>
        
        
            <article class="post">
    <header>
    <div class="title">
        
            <h2><a href="https://jedipunkz.github.io/blog/2014/06/22/jtf2014-ceph/">JTF2014 で Ceph について話してきた！</a></h2>
        
        
    </div>
    <div class="meta">
        
            
        

        <time class="published"
            datetime='2014-06-22'>
            June 22, 2014</time>
        <span class="author"></span>
        
        
    </div>
</header>

    

    
    <p><p>こんにちは。<a href="https://twitter.com/jedipunkz">@jedipunkz</a> です。</p>

<p>今日、JTF2014 (July Tech Festa 2014) というイベントで Ceph のことを話してきま
した。Ceph ユーザ会の会員として話してきたのですが Ceph ユーザ会は実は最近発足
したばかりのユーザ会で、まだまだ活動が活発ではありません。もし興味がある方いらっ
しゃいましたら是非参加よろしくお願いしますー。下記の Google Groups になります。</p>

<p><a href="https://groups.google.com/forum/#!forum/ceph-jp">https://groups.google.com/forum/#!forum/ceph-jp</a></p>

<p>ユーザ会としての勉強会として初になるのですが、今回このイベントで自分は
Ceph-Deploy について話してきました。とりあえず皆さんに使ってもらいたかったので
この話をしてきました。が、予定時間がメチャ短かったので超絶早口で頑張った分、皆
さんに理解してもらえなかった気がしてちょっと反省&hellip;。なので、このブログを利用
して少し細くさせてもらいます。</p>

<p>今日の発表資料はこちらです！</p>

<script async class="speakerdeck-embed"
data-id="592a0b90ceb30131a5d25ae3f95c3a1a" data-ratio="1.33333333333333" src="//speakerdeck.com/assets/embed.js"></script>

<p>今日のテーマは 「Ceph-Deploy を使って Ceph を構築してみる」だったのですが、下
記のテーマを持って資料を作っています。</p>

<ul>
<li>単にミニマム構成ではなく運用を考慮した実用性のある構成</li>
<li>OSD, MON, MDS の各プロセスとノード・ディスクの数の関係を知ってもらう</li>
</ul>

<p>特に「実用性のある..」は意識したつもりでした。そのために前提とした構成に下記の
特徴を持たせています。(資料 6 ページ目に構成図があります。確認してみてください。)</p>

<ul>
<li>オブジェクト格納用ディスクは複数/ノードを前提</li>
<li>OSD レプリケーションのためのクラスタネットワークを用いる構成</li>
<li>OSD の扱うジャーナル格納用ディスクは高速な SSD を用いる</li>
<li>MDS は利用する HW リソースの特徴が異なるので別ノードへ配置</li>
</ul>

<p>ストレージ全体を拡張したければ</p>

<ul>
<li>図中 ceph01-03 の様なノードを増設する</li>
<li>ceph01-03 にディスクとそれに対する OSD を増設する</li>
</ul>

<p>ですが、前者がベストでしょう。ノード増設の場合 ceph-deploy を用いて</p>

<ul>
<li>ceph-deploy mon create &lt;新規ホスト名&gt; で MON を稼働</li>
<li>ceph-dploy disk zap, osd create で OSD を稼働</li>
</ul>

<p>で簡単に可能です。MDS の増設も負荷状況を見ながらするといいでしょう。自分はまだ
Ceph を運用していないので、各プロセスがどのようなリソースの消費の仕方をするの
か知りません。MDS がどのような数で運用していくべきなのか。早く運用から得たノウ
ハウが共有されないかなぁと期待しています。</p>

<p>また今回話すのを忘れたのですが SSD をジャーナル格納用ディスクとして用いたのは
ハードディスクに対して高速でアクセス出来ること・またメタデータはファイルオブジェ
クトに対して小容量で済む、といった理由からです。メタデータを扱うのに適している
と思います。また将来的には幾つかの KVS データベースソフトウェアをメタデータ管
理に使う実装がされるそうです。</p>

<p>以上です。皆さん、是非 Ceph を使ってみてください！ また興味のある方はユーザ会
への加入をご検討くださいー。</p>
</p>

    <footer>
        <ul class="actions">
            <li><a href="https://jedipunkz.github.io/blog/2014/06/22/jtf2014-ceph/" class="button big">Continue Reading</a></li>
        </ul>
        <ul class="stats">
    
        

        
        
            <li>
                
                
                    

                    
                        Categories
                    
                
            </li>
        
    

    
    
        <li><a href='/categories/infrastructure'>infrastructure</a></li>
    
        <li><a href='/categories/report'>report</a></li>
    
</ul>

    </footer>
</article>


        
            <article class="post">
    <header>
    <div class="title">
        
            <h2><a href="https://jedipunkz.github.io/blog/2014/01/21/17th-openstack-study/">第17回 OpenStack 勉強会で話してきました</a></h2>
        
        
    </div>
    <div class="meta">
        
            
        

        <time class="published"
            datetime='2014-01-21'>
            January 21, 2014</time>
        <span class="author"></span>
        
        
    </div>
</header>

    

    
    <p><p>こんにちは。<a href="https://twitter.com/jedipunkz">@jedipunkz</a> です。</p>

<p>昨晩、第17回 OpenStack 勉強会が開催されました</p>

<p><a href="http://connpass.com/event/4545/">http://connpass.com/event/4545/</a></p>

<p>ここで発表をしてきましたぁ！発表タイトルは &ldquo;rcbops/chef-cookbooks&rdquo; です。</p>

<script async class="speakerdeck-embed"
data-id="27a2739063d601314bce6a232911c4f0" data-ratio="1.33333333333333"
src="//speakerdeck.com/assets/embed.js"></script>

<p>何を発表したかと言うと詳しくは上記のスライドを見ていただくとして、簡単に言うと
&ldquo;RackSpace 社のエンジニアが管理している Chef Cookbooks でOpenStack 構成を作ろ
う&rdquo; ってことです。</p>

<p>今日知ったのですがどうも昨晩は初心者向けの勉強会という位置付けだったらしく..少
しだけディープな話題を話してしまったかもしれません！すいません！＞＜</p>

<p>でもとても楽しく発表出来ましたし、逆に質問のコーナーで最新の情報も教えてもらえ
たり！なんと Havana 対応の v4.2.0 以降では Swift の Cookbooks が消えてしまった
とか！&hellip; 皆 Swift 好きくないの？&hellip;; ;</p>

<p>rcbops/chef-cookbooks はずっと追っていますが、ものすごいスピードで開発進んでい
るので、今後ぜひみなさん使ってみて下さいー。</p>

<p>最後に詳しい利用方法を記した僕のブログの URL を貼り付けておきます。</p>

<ul>
<li>OpenStack Havana を Chef でデプロイ</li>
</ul>

<p><a href="http://jedipunkz.github.io/blog/2013/11/17/openstack-havana-chef-deploy/">http://jedipunkz.github.io/blog/2013/11/17/openstack-havana-chef-deploy/</a></p>

<ul>
<li>Swift HA 構成を Chef でデプロイ</li>
</ul>

<p><a href="http://jedipunkz.github.io/blog/2013/07/26/swift-ha-chef-deploy/">http://jedipunkz.github.io/blog/2013/07/26/swift-ha-chef-deploy/</a></p>

<ul>
<li>実用的な Swift 構成を Chef でデプロイ</li>
</ul>

<p><a href="http://jedipunkz.github.io/blog/2013/10/27/swift-chef/">http://jedipunkz.github.io/blog/2013/10/27/swift-chef/</a></p>
</p>

    <footer>
        <ul class="actions">
            <li><a href="https://jedipunkz.github.io/blog/2014/01/21/17th-openstack-study/" class="button big">Continue Reading</a></li>
        </ul>
        <ul class="stats">
    
        

        
        
            <li>
                
                
                    

                    
                        Categories
                    
                
            </li>
        
    

    
    
        <li><a href='/categories/infrastructure'>infrastructure</a></li>
    
        <li><a href='/categories/report'>report</a></li>
    
</ul>

    </footer>
</article>


        
            <article class="post">
    <header>
    <div class="title">
        
            <h2><a href="https://jedipunkz.github.io/blog/2013/09/29/devops-day-tokyo-2013-report/">DevOps Day Tokyo 2013 参加レポート</a></h2>
        
        
    </div>
    <div class="meta">
        
            
        

        <time class="published"
            datetime='2013-09-29'>
            September 29, 2013</time>
        <span class="author"></span>
        
        
    </div>
</header>

    

    
    <p><p>こんにちは。@jedipunkz です。</p>

<p>DevOps Day Tokyo 2013 に参加してきました。たくさんの刺激を受けたのでレポート書
いておきます。</p>

<pre><code>開催日 : 2013年09月28日
場所   : 東京六本木ミッドタウン Yahoo! Japan さま
URL    : http://www.devopsdays.org/events/2013-tokyo/
</code></pre>

<h1 id="making-operation-visible">Making Operation Visible</h1>

<pre><code>Nick Galbreath (@ngalbreath) さん
</code></pre>

<p>DevOps の拠点 Etsy に努めた経緯のある DevOps リーダ Galbreath さん。DevOps の
概略から何が必要でありどう行動に起こせばよいか説明してくださいました。</p>

<p><iframe src="http://www.slideshare.net/slideshow/embed_code/26632342"
width="427" height="356" frameborder="0" marginwidth="0" marginheight="0"
scrolling="no" style="border:1px solid #CCC;border-width:1px 1px
0;margin-bottom:5px" allowfullscreen> </iframe> <div
style="margin-bottom:5px"> <strong> <a
href="https://www.slideshare.net/nickgsuperstar/making-operations-visible-dev-opsdays-tokyo-2013key"
title="Making operations visible - devopsdays tokyo 2013"
target="_blank">Making operations visible - devopsdays tokyo 2013</a>
</strong> from <strong><a href="http://www.slideshare.net/nickgsuperstar"
target="_blank">Nick Galbreath</a></strong> </div></p>

<p>こちら、Galbreath さんの当日の資料。</p>

<h2 id="devops-が実行出来ない理由">DevOps が実行出来ない理由</h2>

<ul>
<li>Tool が足りない</li>
<li>社風の影響</li>
<li>見えないモノが価値がないと事業から考えられている</li>
</ul>

<p>出来る事は、価値があるモノの社内への説明と、Tool を使った可視化。データの可視
化が重要。Ops の人は結構「データをどこそこの部署に見せても理解してもらえない」
だとか「データを閲覧させると万が一の時にシステムが破損する」等と考えがち。が、
ビジネス寄りの人にとって重要なグラフが含まれていたり、アカウント担当の人に役立
つものも含まれている。ましてシステムが破損することなど決して無い。</p>

<p>重要なのは &ldquo;運用のメトリクスを公開する&rdquo; こと！</p>

<h2 id="graphite">Graphite</h2>

<ul>
<li>グラフ描画ツール</li>
<li>まず完成度が高いわけではない</li>
<li>同類のソフトウェアでは行えないクエリが発行出来る</li>
<li>REST API</li>
<li>Flexible Input &amp; Output</li>
<li>Simple UI &amp; Dashboard</li>
<li>3rd Party Custom Client Side Dashboard あり</li>
<li>URL 型なので Dashboard 開発が楽ちん</li>
<li>稼働させるための物理インフラリソースは結構必要</li>
<li>apt-get install graphite できるよ</li>
</ul>

<h2 id="statd">statd</h2>

<ul>
<li>UDP 使ってる</li>
<li>Event Data を Application から statd へ</li>
</ul>

<p>下記は例。ログイン情報を送るためのコードはこれだけ。</p>

<pre><code>StatD::increment('logins')
</code></pre>

<p>国別にも出来る。</p>

<pre><code>StatD::increment('logins');
$kuni = geoip2country($ipv4);
StatD::increment('logins.$kuni')
</code></pre>

<p>後に DataDog の方から詳しく説明がある。</p>

<h1 id="sensu">Sensu</h1>

<pre><code>Sean Porter さん
</code></pre>

<p>メモとりにくいプレゼンだったので思い出しながら&hellip;.</p>

<p>Sensu は Nagios のプラグイン等がそのまま再利用できる監視ツール。API を介してア
ラートの具合やクライアントのリスト・監視項目のリスト等が取得できます。Nagios
を使った場合、ターゲットノードの追加のたびにコンフィギュレーションを生成しなく
てはならなかったり不便だったのが Sensu を開発しようとした動機だとか。Chef との
親和性が高く、Chef Cookbook の公開もしている。私も実際に使っていますが、</p>

<ul>
<li>Sensu サーバの構築</li>
<li>監視項目の追加</li>
<li>ターゲットノードへのアージェントの追加</li>
</ul>

<p>等はすべて Chef の Knife コマンドで出来ます。特に Chef からの影響だと思われる
が Omnibus 形式のパッケージを採用していることもあり、エージェントのインストー
ルは簡単です。パッケージの中に動作に必要な Ruby 一式も含まれています。</p>

<p>ドキュメントは下記のところにあります。</p>

<p><a href="http://docs.sensuapp.org/0.10/index.html">http://docs.sensuapp.org/0.10/index.html</a></p>

<h1 id="puppet">puppet</h1>

<pre><code>max martin
</code></pre>

<p>for next level
+++</p>

<ul>
<li>Puppet 3.x</li>
<li>Hiera integration</li>
<li>PuppetDB</li>
<li>Mcollective 2.x</li>
<li>Geppetto : IDE</li>
<li>Puppet Forge : web site</li>
</ul>

<p>Puppet が提供するソフトウェアやサービス達。DevOps の次のステップへの必要な技術
要素。</p>

<h2 id="puppet-3-x">puppet 3.x</h2>

<ul>
<li>pupput2 に比較して speedup x 3</li>
<li>agents/server : 100% up</li>
<li>これらは理論値ではなく実効値！</li>
</ul>

<p>Puppet2 と比較してかなりの性能アップらしい。処理速度3倍は実効値だそうです。</p>

<h2 id="puppet3-0-hiera-functions-data-bindings">puppet3.0 = hiera functions + data bindings</h2>

<ul>
<li>hiera : hierarchical key value store with pluggable backend (json, yaml..)</li>
<li>keep site specific data out of puppet code</li>
<li>parameter values are now automatically looked up in hiera</li>
<li>data bind でコードがシンプルに : include ntp -&gt; yaml, json..</li>
</ul>

<p>json や yaml でパラメータを記述出来るのでコードがシンプルで綺麗になるよ、との
こと。Chef でいう Attributes だと思われる。</p>

<h2 id="puppetdb">puppetdb</h2>

<ul>
<li>puppet データすべてを格納 (facts, catalogs, reports,..)</li>
<li>replaces existing library is much faster and more faster</li>
<li>postgreSQL, Clojure, JVM -&gt; JAR ファイルで展開</li>
<li>クエリシンタックスを自ら定義可能</li>
<li>API がシンプルなので dashboard などの開発も簡単</li>
</ul>

<p>PostgreSQL が最近あちらの国ではイケてるっていう話はよく聞いていたけど Puppet3
は PostgreSQL, Clojur, JVM の組み合わせで構成されているらしい。Chef も Erlang
に置き換わったあたりを見ての反応かなぁ？と想像。</p>

<h2 id="mcollective">MCollective</h2>

<ul>
<li>orchestration engine</li>
<li>ruby を使って独自のエージェント開発可能</li>
<li>mco rpc service restart service=httpd &ndash;nodes=hosts.txt # query a file</li>
<li>mco rpc service restart service=httpd -W country=uk -dm=puppetdb # discover</li>
<li>mco rpc rpcutil ping -I example.com # direct addressing</li>
<li>ruby のライブラリとして利用可能</li>
</ul>

<p>query a file のサンプル</p>

<pre><code>c = rpcclient(&quot;service&quot;)
c.discover :nodes =&gt; File.readline(&quot;host.txt&quot;).map {|i| i.chomp}
printrpc c.restart(:service =&gt; &quot;httpd&quot;)
</code></pre>

<p>これはオーケストレーションツール。ホスト名の記述されたファイルから、それらのホ
ストに対して一斉に指示を送ったり検索を行ったりコマンドの実行が出来る。これは
Ruby ライブラリとして再利用出来るらしい。これは便利。</p>

<h2 id="geppetto">Geppetto</h2>

<ul>
<li>IDE for developing puppet modules and code</li>
<li>git &amp; svn</li>
<li>Linux, Mac OSX, Windows</li>
</ul>

<p>Linux, Mac, Windows 用の IDE まで提供してるんですね。驚き。Puppet ものすごい勢
い。</p>

<h2 id="puppet-forge">Puppet Forge</h2>

<ul>
<li>module repository</li>
<li>1,500+ modules</li>
<li>puppet module install foo/foo</li>
<li>module のためのチームが内部にある</li>
</ul>

<p>コミュニティの作ったモジュールを公開しているレポジトリ WEB サービス。1,500 以
上のモジュールが公開されているらしい。このためのチームも Puppet 社内にいるとか。</p>

<h1 id="迷ったら健全な方を">迷ったら健全な方を</h1>

<pre><code>Cookpad Naruta Issei さん
</code></pre>

<script async class="speakerdeck-embed"
data-id="bd487ad00a49013116811a94ecd7685c" data-ratio="1.33333333333333"
src="//speakerdeck.com/assets/embed.js"></script>

<p>印象的なプレゼンでした。</p>

<p>現実に起こった問題を切り口に Devops について語っていました。リリース日当日 Ops
が「今日リリースだと初めて知る」という事件。繰り返さないためにどうするか？</p>

<ul>
<li>リリース日の決定に Ops の承認が必要なルールにする？</li>
<li>Ops 「ソースコードが fix してからリリース日まで3営業日必要？」</li>
</ul>

<p>このようなルールを作りがちだけど、これでは Ops が権威になってしまう。Ops の立
場からしてこの「権威」になりやすいという特徴があるが、Ops はそう振る舞ってはい
けない！という話。DevOps に必要なコミュニケーションで回避出来ると。DevOps であ
る限り仕事は楽しくなくてはならない。承認を取るテクニック・政治が発生するのもこ
れまた問題。</p>

<p>Cookpad はこれからもコミュニケーションでこういった問題をクリアしていく！と宣言
がありました。最後は若干 Ops 避難のようなプレゼンを Ops の前でするかのような状
況に Issei さんも声を震わせながらのプレゼンでしたが、逆にそれが僕には響きまし
た。ぼくも Ops 出身だし、こういった問題は嫌になる程見てきているので、この訴え
かけはガツンときた。プレゼン最高でした！</p>

<h1 id="datadog">DataDog</h1>

<pre><code>Alexis Lê-Quôc さん
</code></pre>

<p>監視ツールにとっての重要な要素</p>

<ul>
<li>Timely</li>
<li>Correct</li>
<li>Comprehensive (包括的)
<br /></li>
</ul>

<p>これらを満たせなければ全く無駄。</p>

<ul>
<li>前提条件を元にメトリクスを決めている -&gt; 不完全なメトリクスが多い</li>
<li>-&gt; 最低限の条件でメトリクスに要素を追加できることが重要だと考える
<br /></li>
</ul>

<h2 id="statd-types">statd types</h2>

<ul>
<li>gauges</li>
<li>counters</li>
<li>histgrams</li>
<li>timers</li>
<li>sets</li>
</ul>

<h2 id="参考資料">参考資料</h2>

<p>statd と graphite の連携</p>

<p><a href="https://github.com/etsy/statsd/blob/master/docs/graphite.md">https://github.com/etsy/statsd/blob/master/docs/graphite.md</a></p>

<p>サポートされているバックエンド一覧</p>

<p><a href="https://github.com/etsy/statsd/blob/master/docs/backend.md">https://github.com/etsy/statsd/blob/master/docs/backend.md</a></p>

<h1 id="まとめ">まとめ</h1>

<p>とても有意義だった。丸一日、最後まで聞いているのも辛かったけど、運営されている
側の方々はもっと大変だったでしょう。ありがとうございました。日本ではなかなか話
を聞けないめちゃホットな方々の話を直に聞けるなんて無いのでホント貴重でした。ま
たディスカッションには参加出来なかったけど、久しぶりに会えた方がいてめちゃ良かっ
たです。同じ方向向いている方々がこれだけ社外には居るんだという気付きもあったり。</p>

<p>皆さん、ありがとうございました！</p>
</p>

    <footer>
        <ul class="actions">
            <li><a href="https://jedipunkz.github.io/blog/2013/09/29/devops-day-tokyo-2013-report/" class="button big">Continue Reading</a></li>
        </ul>
        <ul class="stats">
    
        

        
        
            <li>
                
                
                    

                    
                        Categories
                    
                
            </li>
        
    

    
    
        <li><a href='/categories/infrastructure'>infrastructure</a></li>
    
        <li><a href='/categories/report'>report</a></li>
    
</ul>

    </footer>
</article>


        
            <article class="post">
    <header>
    <div class="title">
        
            <h2><a href="https://jedipunkz.github.io/blog/2013/09/09/14th-openstack-study-hackathon/">第14回 OpenStack 勉強会参加ログ</a></h2>
        
        
    </div>
    <div class="meta">
        
            
        

        <time class="published"
            datetime='2013-09-09'>
            September 9, 2013</time>
        <span class="author"></span>
        
        
    </div>
</header>

    

    
    <p><p>こんにちは。@jedipunkz です。</p>

<p>OpenStack 第14回勉強会 ハッカソンに参加してきました。その時の自分の作業ログを
記しておきます。自分の作業内容は &lsquo;OpenStack + Docker 構築&rsquo; です。</p>

<pre><code>場所 : CreationLine さま
日時 : 2013年9月8日(土)
</code></pre>

<p>当日の atnd。</p>

<p><a href="http://atnd.org/events/42891">http://atnd.org/events/42891</a></p>

<p>当日発表のあった内容</p>

<ul>
<li>Ansible で OpenStack を実際に皆の前でデプロイ！</li>
<li>Yoshiyama さん開発 LogCas お披露目</li>
<li>Havana の機能改善・機能追加内容確認</li>
<li>その他 Horizon の機能についてだったり openstack.jp の運用についてなど</li>
</ul>

<p>自分が話を聞きながら黙々とやったことは</p>

<ul>
<li>OpenStack + Docker 構築</li>
</ul>

<p>結果&hellip; NG 動かず。時間切れ。公式の wiki の手順がだいぶ変なので手順を修正しながら進めました。</p>

<p>公式の wiki はこちらにあります。</p>

<p><a href="https://wiki.openstack.org/wiki/Docker">https://wiki.openstack.org/wiki/Docker</a></p>

<p>その修正しながらメモった手順を下記に貼り付けておきます。</p>

<h2 id="作業環境">作業環境</h2>

<ul>
<li>ホスト : Ubuntu 12.04.3 Precise</li>
<li>OpenStack バージョン : devstack (2013/09/08 master ブランチ)</li>
<li>構成 : オールインワン (with heat, ceilometer, neutron)</li>
</ul>

<h2 id="普通に動かすとエラーが出力される">普通に動かすとエラーが出力される</h2>

<p>これは devstack (2013/09/08 時点) での不具合なので直ちに修正されるかも。</p>

<p>デフォルトのエンコーディングが &lsquo;ascii&rsquo; になっているのが原因らしい.</p>

<pre><code class="language-python">% python
Python 2.7.3 (default, Apr 10 2013, 06:20:15)
[GCC 4.6.3] on linux2
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
&gt;&gt;&gt; import sys
&gt;&gt;&gt; sys.getdefaultencoding()
'ascii'
&gt;&gt;&gt;
</code></pre>

<h2 id="エラーの内容は">エラーの内容は…</h2>

<p>この状態だと… 下記のようなエラーが nova から出力される。むむむ。</p>

<pre><code class="language-bash">% nova boot --image &quot;ubuntu:latest&quot; --flavor 1 vm01
ERROR: UnicodeError: 'ascii' codec can't decode byte 0xe5 in position 2: ordinal not in range(128) (HTTP 400) (Request-ID: req-40ebfb9b-d76a-40b8-8f75-facb4dd73db4)
</code></pre>

<p>とりあえず暫定処置として、下記のように setdefaultencoding(&lsquo;utf-8&rsquo;) を追記。ち
なみに devstack デプロイ前にこの作業を済ませました。デプロイ後だと色々めんどい。
当日、何度もめんどい場面に遭遇しました&hellip;</p>

<pre><code class="language-bash">% ${EDITOR} /usr/lib/python2.7/sitecustomize.py
# install the apport exception handler if available
try:
    import apport_python_hook
except ImportError:
    pass
else:
    apport_python_hook.install()

# 下記の2行を追記
import sys
sys.setdefaultencoding('utf-8')
</code></pre>

<h2 id="ubuntu12-04-の場合-linux-kernel-3-8-にアップデート">Ubuntu12.04 の場合 Linux Kernel 3.8 にアップデート</h2>

<p>wiki には載っていないが docker が Linux Kernel 3.8 以上を推奨しているため
raring から 3.8 を持ってくる。</p>

<pre><code class="language-bash">% sudo apt-get update
% sudo apt-get install linux-image-generic-lts-raring linux-headers-generic-lts-raring
% sudo reboot
</code></pre>

<h2 id="socat-インストール">socat インストール</h2>

<p>後に実行する install_docker.sh スクリプトが必要とする。実行前に入れないとと痛
い目見る。当日何度も痛い目見ました&hellip;</p>

<pre><code class="language-bash">% sudo apt-get install socat
</code></pre>

<h2 id="localrc-追記">localrc 追記</h2>

<p>localrc に下記を追記。その他のパラメータは各自のモノで良い。</p>

<pre><code>VIRT_DRIVER=docker
</code></pre>

<h2 id="install-docker-sh-実行">install_docker.sh 実行</h2>

<p>一般ユーザ権限で OK 。中で sudo している。が、極稀に sudo のタイムアウトが来る
ので、色々しんどい。ちなみに僕はここで何度もやりなおしました。&hellip;</p>

<pre><code class="language-bash">% ./tools/docker/install_docker.sh
</code></pre>

<h2 id="devstack-インストール">devstack インストール</h2>

<p>devstack をデプロイする。</p>

<pre><code class="language-bash">% ./stack.sh
</code></pre>

<h2 id="index-docker-io-から-ubuntu-イメージをダウンロード">index.docker.io から &lsquo;ubuntu&rsquo; イメージをダウンロード</h2>

<p>index.docker.io のトップレベルから &lsquo;ubuntu&rsquo; イメージを取得。どのイメージでも良い。</p>

<pre><code class="language-bash">% sudo docker pull ubuntu
Pulling repository ubuntu
8dbd9e392a96: Download complete
b750fe79269d: Download complete
27cf78414709: Download complete
````

docker-registry (プライベートレポジトリ) に対して push する -&gt; Glance に登録
----

この状態で docker-registry.sh というプロセスが起動しているはず。これは docker   
のプライベートレポジトリに相当。5042 tcp で待ち受けているので下記のように tag を打った後、プライベートレポジトリに
アップロード。

``` bash
% sudo docker tag ubuntu 10.200.9.25:5042/ubuntu
% sudo docker push 10.200.9.25:5042/ubuntu
The push refers to a repository [10.200.9.25:5042/ubuntu] (len: 1)
Sending image list
Pushing repository 10.200.9.25:5042/ubuntu (1 tags)
Pushing 8dbd9e392a964056420e5d58ca5cc376ef18e2de93b5cc90e868a1bbc8318c1c
Pushing tags for rev [8dbd9e392a964056420e5d58ca5cc376ef18e2de93b5cc90e868a1bbc8318c1c] on {http://10.200.9.25:5042/v1/repositories/ubuntu/tags/latest}
</code></pre>

<p>docker のレポジトリについてはここが参考になる。</p>

<p><a href="http://docs.docker.io/en/latest/use/workingwithrepository/">http://docs.docker.io/en/latest/use/workingwithrepository/</a></p>

<h2 id="glance-に登録されていることを確認">glance に登録されていることを確認</h2>

<p>&lsquo;ubuntu:latest&rsquo; が表示されるはず。やった。</p>

<pre><code class="language-bash">% glance image-list
+--------------------------------------+---------------------------------+-------------+------------------+----------+--------+
| ID                                   | Name                           | Disk Format | Container Format | Size  | Status |
+--------------------------------------+---------------------------------+-------------+------------------+----------+--------+
| f5845be4-1ac0-42c7-9280-a8c316be6beb | cirros-0.3.1-x86_64-uec         | ami       | ami            | 25165824 | active |
| aa8bcdff-6eb9-402b-9e27-675648dbe311 | cirros-0.3.1-x86_64-uec-kernel  | aki       | aki            | 4955792  | active |
| f8857736-5613-401a-b28c-02c286271af4 | cirros-0.3.1-x86_64-uec-ramdisk | ari       | ari            | 3714968  | active |
| ae56cacb-7eb6-413e-bd75-46f3cd63123b | docker-busybox:latest         | raw         | docker          | 2271796  | active |
| 613b05c3-30f6-4c53-aa94-103ea516373e | ubuntu:latest                 | raw         | docker          | 71497587 | active |
+--------------------------------------+---------------------------------+-------------+------------------+----------+--------+
</code></pre>

<h2 id="nova-boot">nova boot</h2>

<p>ぐったり&hellip; nova-scheduler がエラー吐いてるぽいけど、原因つかめず。ハッカソン時間切れ。</p>

<pre><code class="language-bash">% nova boot --image &quot;ubuntu:latest&quot; --flavor m1.tiny vm01
% nova list
+--------------------------------------+------+--------+------------+-------------+----------+
| ID                                   | Name | Status | Task State | Power State | Networks |
+--------------------------------------+------+--------+------------+-------------+----------+
| e1563b55-bb5d-43a6-a1fc-c3bc63600ac7 | vm01 | ERROR  | None       | NOSTATE     |          |
+--------------------------------------+------+--------+------------+-------------+----------+
</code></pre>

<h2 id="エラー内容">エラー内容..</h2>

<p>下記のエラーが出力されていた。なんだか OpenStack のメッセージじゃないような。
調べてたら素の Python のメッセージらしく。うーん。devstack なので仕方ない。</p>

<pre><code>    Sep  7 14:53:08 devstack01 2013-09-07 14:53:08.490 ERROR nova.compute.manager [req-d4ff6a45-88bc-4d6e-8f9d-43de79e601c6 demo demo] [instance: fdd0fdfb-aaa2-4e91-98cc-cdb347e9ae09] Instance failed to spawn#0122013-09-07 14:53:08.490 31835 TRACE nova.compute.manager [instance: fdd0fdfb-aaa2-4e91-98cc-cdb347e9ae09] Traceback (most recent call last):#0122013-09-07 14:53:08.490 31835 TRACE nova.compute.manager [instance: fdd0fdfb-aaa2-4e91-98cc-cdb347e9ae09]   File &quot;/opt/stack/nova/nova/compute/manager.py&quot;, line 1416, in _spawn#0122013-09-07 14:53:08.490 31835 TRACE nova.compute.manager [instance: fdd0fdfb-aaa2-4e91-98cc-cdb347e9ae09]     block_device_info)#0122013-09-07 14:53:08.490 31835 TRACE nova.compute.manager [instance: fdd0fdfb-aaa2-4e91-98cc-cdb347e9ae09]   File &quot;/opt/stack/nova/nova/virt/docker/driver.py&quot;, line 305, in spawn#0122013-09-07 14:53:08.490 31835 TRACE nova.compute.manager [instance: fdd0fdfb-aaa2-4e91-98cc-cdb347e9ae09]     raise exception.InstanceDeployFailure(msg.format(e),#0122013-09-07 14:53:08.490 31835 TRACE nova.compute.manager [instance: fdd0fdfb-aaa2-4e91-98cc-cdb347e9ae09]   File &quot;/opt/stack/nova/nova/openstack/common/gettextutils.py&quot;, line 255, in __getattribute__#0122013-09-07 14:53:08.490 31835 TRACE nova.compute.manager [instance: fdd0fdfb-aaa2-4e91-98cc-cdb347e9ae09]     return UserString.UserString.__getattribute__(self, name)#0122013-09-07 14:53:08.490 31835 TRACE nova.compute.manager [instance: fdd0fdfb-aaa2-4e91-98cc-cdb347e9ae09] AttributeError: 'Message' object has no attribute 'format'#0122013-09-07 14:53:08.490 31835 TRACE nova.compute.manager [instance: fdd0fdfb-aaa2-4e91-98cc-cdb347e9ae09]
</code></pre>

<h2 id="所感とまとめ">所感とまとめ</h2>

<p>前半の1,2時間、みなさんの話に聞き入ってしまったので時間が…。発表の内容も皆さ
んの会話も楽しかった。また参加したい。Netron 周りで聞きたい事とか色々あったの
だけどコアデベロッパの方に聞けなかったのが後悔。今度教えてもらおう。あとやっぱ
りみなさん詳しい。その情報どこから？ということまでよく知っているし知識が深い。
理解度がまだまだちゃうなぁと実感。次回も参加させていただこうと思います。</p>
</p>

    <footer>
        <ul class="actions">
            <li><a href="https://jedipunkz.github.io/blog/2013/09/09/14th-openstack-study-hackathon/" class="button big">Continue Reading</a></li>
        </ul>
        <ul class="stats">
    
        

        
        
            <li>
                
                
                    

                    
                        Categories
                    
                
            </li>
        
    

    
    
        <li><a href='/categories/infrastructure'>infrastructure</a></li>
    
        <li><a href='/categories/report'>report</a></li>
    
</ul>

    </footer>
</article>


        
            <article class="post">
    <header>
    <div class="title">
        
            <h2><a href="https://jedipunkz.github.io/blog/2013/04/06/cloudmanagement/">クラウドマネジメント勉強会レポ</a></h2>
        
        
    </div>
    <div class="meta">
        
            
        

        <time class="published"
            datetime='2013-04-06'>
            April 6, 2013</time>
        <span class="author"></span>
        
        
    </div>
</header>

    

    
    <p><p>クラウドマネジメント勉強会に参加してきた。今が旬なのか定員140名が埋まっていま
した。クラウドフェデレーションサービス各種の話が聞ける貴重な勉強会の場でした。</p>

<pre><code>場所 : スクエアエニックスさん
日程 : 2013年4月5日 19:00 -
</code></pre>

<p>少し長くなるので、早速。</p>

<h2 id="クラウド運用管理研究会">クラウド運用管理研究会</h2>

<p>クラウド利用推進機構が運営するクラウド運用管理研究会は下記の3つに分別されるそ
うです。今回は一項目の &lsquo;クラウドマネジメントツール研究会&rsquo; にあたるそう。別の研
究会も既に勉強会を実施しているそうです。</p>

<ul>
<li>クラウドマネジメントツール研究会</li>
<li>デザインパターン研究会</li>
<li>運用管理・監視研究会</li>
</ul>

<h1 id="aws-opsworks">AWS OpsWorks</h1>

<pre><code>アマゾンデータサービスジャパン AWS 片山さん, 船崎さん
</code></pre>

<p>OpsWorks は最近話題になった AWS 利用者に無料で提供されるクラウドフェデレーショ
ンサービス。Web UI で操作し簡単デプロイを実現するサービスです。</p>

<h2 id="opsworks-が自動化するモノ">OpsWorks が自動化するモノ</h2>

<ul>
<li>サーバ設定</li>
<li>ミドルウェア構築</li>
</ul>

<h2 id="特徴">特徴</h2>

<ul>
<li>Chef フレームワークを利用 (chef-solo を内部的に利用)</li>
<li>任意の cookbooks を利用可能</li>
<li>LB, AP, DB などをレイヤ化, 任意のレイヤも作成可能</li>
</ul>

<h2 id="opsworks-の流れ">OpsWorks の流れ</h2>

<ul>
<li>Stack 作成</li>
<li>レイヤ作成 (LB, AP, DB, 任意)</li>
<li>レシピの作成</li>
<li>レイヤにインスタンス作成</li>
</ul>

<h2 id="下記をレイヤ化で区別する">下記をレイヤ化で区別する</h2>

<ul>
<li>Package インストール</li>
<li>OS 設定</li>
<li>アプリデプロイ</li>
</ul>

<h2 id="所感">所感</h2>

<p>AWS OpsWorks の登場で他のクラウドフェデレーションサービスがどうなるの？とさえ
思った。AWS はインターネット・ホスティング業界のあらゆるサービスを押さえようと
している感がある。もう隙間がない！ｗ OpsWorks に関してまだ問題は残っているそう
だ。VPC, micro 現在未対応など。が解決に向けて作業しているそう。</p>

<h1 id="aeolus-conductor">Aeolus Conductor</h1>

<pre><code>RedHat 中井さん
</code></pre>

<h2 id="概要">概要</h2>

<p>複数クラウドに対応したイメージ作成・アプリケーション環境構築の自動化ツール</p>

<ul>
<li>アプリのデプロイ機能にフォーカス</li>
<li>Red Hat CoudForms が商用版</li>
<li>マルチクラウド (ユーザにクラウドが割り当てられる, Hybrid, EC2, RHEV)</li>
</ul>

<h2 id="自動化について中井さんの案-手作り">自動化について中井さんの案 (手作り)</h2>

<ul>
<li>libvirt キック</li>
<li>kickstart 実行</li>
<li>post script にて puppet 実行</li>
<li>manifest は github で管理</li>
</ul>

<p>これらは単一のサーバのみで実施できて、複数台構成等を前提に出来ない等の問題があ
る。それらを解決するのが Aeolus Conductor。</p>

<h2 id="aeolus-conductor-の要素">Aeolus Conductor の要素</h2>

<ul>
<li>システムテンプレート用意 (XML) : OS 構成内容が記されている</li>
<li>マシンイメージ JEOS</li>
<li>アプリケーションブループリント (アプリデプロイ設計書)
shell script である。puppet, chef を呼び出しても OK.</li>
<li>Config サーバを介して VM 間の構成を管理している : インテグレート！ DB, Web</li>
</ul>

<h2 id="aeolus-conductor-の不便な点">Aeolus Conductor の不便な点</h2>

<ul>
<li>特定のクラウド特有の機能には未対応</li>
<li>複数 VM デプロイ時のワークフロー処理が不十分</li>
</ul>

<h2 id="所感-1">所感</h2>

<p>画面を見させてもらったが AWS EC2, RHEV (RedHat の仮想化ソフト) とマルチクラウ
ドに対応していた。ユーザにどのクラウドを割り当てるか？等の権限委譲が出来るもの
ユニーク。</p>

<h1 id="scalr">Scalr</h1>

<pre><code>Scalr ユーザ会 梶川さん (IDC フロンティア)
</code></pre>

<h2 id="概要-特徴">概要, 特徴</h2>

<ul>
<li>オープンソースのマルチクラウド管理ツール</li>
<li>利用出来るクラウド : AWS, Eucalyptus, RackSpace, nimbula, OpenStack, &hellip;</li>
<li>冗長化・オートスケール可能</li>
<li>モニタリングも自動で開始</li>
<li>DNS 管理, オートスケール時、自動的に修正が行われる</li>
<li>スクリプト実行 (任意のタイミングで可能、またタイミングを作成可能)</li>
<li>各サービスのコンフィグプリセット管理 (ミドルウェアのパラメータ？)</li>
</ul>

<h2 id="所感-2">所感</h2>

<p>Scalr ユーザ会のメンバ募集中だそうだ。個人的にオープンソースの Scalr を試そう
と思ったことがあるのだが、手順の wiki が解りづらかった。商用サービスを使わせる
ためにわざと解りづらくしているのか？と思うほど。ユーザ拡大のために是非ドキュメ
ントの整備をお願いしたい。</p>

<h1 id="rightscale-の利用効果と苦労話">RightScale の利用効果と苦労話</h1>

<pre><code>So-net エンタテインメント 成田さん
</code></pre>

<h2 id="利用効果">利用効果</h2>

<ul>
<li>1つのスクリプトを複数台に対して実行可能</li>
<li>手作業が自動化へ</li>
<li>ベストプラクティスの利用が可能に</li>
<li>モニタリングの自動化へ</li>
<li>サーバ台数のスケジューリング化</li>
<li>セキュリティグループはマクロで作成</li>
<li>権限分離による開発者・プロデューサに役割移譲</li>
<li>履歴管理の自動記録</li>
<li>chef recipe が right スクリプトとして走らせられる</li>
</ul>

<h2 id="苦労話">苦労話</h2>

<ul>
<li>Alert 設定のミスでメール大量受信</li>
<li>自動化スクリプトのエラー対応</li>
<li>計画メンテナンスの後は要注意 (仕様変更)</li>
<li>RightScale 上の表示を過信しない, 詳しくはクラウドサービス側を確認</li>
<li>LANG=ja_JP.UTF-8 するとコケる</li>
<li>メンテナンスは金曜日日中 (月に一回)</li>
</ul>

<h2 id="所感-3">所感</h2>

<p>実際に運用している方の話はとても貴重。特に苦労ネタはなかなか知ることが出来ない
ので。自動化のためにスクリプトを書くのがインフラ系エンジニアの仕事になると知ら
せてくれた。Right スクリプトには Chef のレシピも走らせることが出来る、というも
が魅力。またインフラ系エンジニア以外の職種の人にも権限委譲し UI を操作してもら
える辺りは、業務の最適化のために大いに利用できると感じた。</p>

<h1 id="chef-の話">Chef の話</h1>

<pre><code>Engine Yard @yando さん
</code></pre>

<h2 id="engine-yard-とは">Engine Yard とは</h2>

<ul>
<li>PaaS</li>
<li>AWS + Chef + サポート, 監視</li>
<li>chef-solo をキック</li>
<li>chef recipe の管理は Engine Yard が行う</li>
</ul>

<h2 id="chef-へのモチベーション">Chef へのモチベーション</h2>

<ul>
<li>冪等性</li>
<li>シェルスクリプトだと構築直後の状態しか保証されない</li>
</ul>

<h2 id="chef-solo-の話">chef-solo の話</h2>

<ul>
<li>knife-solo でノードに SSH せずに実行</li>
</ul>

<h2 id="利用するにあたって直面する課題">利用するにあたって直面する課題</h2>

<ul>
<li>レシピの実装 -&gt; github 上のレシピを参照・利用</li>
<li>Vagrant の利用でレシピの複数プラットフォーム上でのテスト</li>
<li>レシピの配布方法 -&gt; github, berkshelf, knife solo, nfs, chef-server</li>
<li>レシピの反映 -&gt; capistrano, chef-client, cron</li>
</ul>

<h2 id="engine-yard-local">Engine Yard Local</h2>

<ul>
<li>クラウドと同じレシピでローカルに開発環境を構築出来るツール</li>
<li>クラウドはコストが掛かるし遅いので出来る事ならローカルで、という発想</li>
</ul>

<h2 id="所感-4">所感</h2>

<p>Chef 流行ってますね。うんうん、(・∀・)ｲｲ!! 個人的には Chef の Cookbooks 開発
はインフラエンジニアにしてもらいたい。Engine Yard のような PaaS 使うならアレだ
けどクラウド使うなら運用は引き続き必要だし、運用を意識した Cookbooks 開発は絶
対に必要になってくるからだ。Chef の関連技術がものすごいスピードで進化している
のも魅力。より便利で旬な技術をすぐに利用し貢献する、という良いサイクルをうちの
会社でも実現したい。だって楽しいから。chef-solo 使うの？chef サーバ使うの？と
いう話はここでも挙がってた。どこかでブログにしようかな。僕は chef サーバ使わな
い理由がないと思ってる。</p>
</p>

    <footer>
        <ul class="actions">
            <li><a href="https://jedipunkz.github.io/blog/2013/04/06/cloudmanagement/" class="button big">Continue Reading</a></li>
        </ul>
        <ul class="stats">
    
        

        
        
            <li>
                
                
                    

                    
                        Categories
                    
                
            </li>
        
    

    
    
        <li><a href='/categories/infrastructure'>infrastructure</a></li>
    
        <li><a href='/categories/report'>report</a></li>
    
</ul>

    </footer>
</article>


        
            <article class="post">
    <header>
    <div class="title">
        
            <h2><a href="https://jedipunkz.github.io/blog/2013/02/10/di-11hui-openstack-study11-openstack-chef-repo/">第11回OpenStack勉強会で話してきた</a></h2>
        
        
    </div>
    <div class="meta">
        
            
        

        <time class="published"
            datetime='2013-02-10'>
            February 10, 2013</time>
        <span class="author"></span>
        
        
    </div>
</header>

    

    
    <p><p>2013年2月9日に行われた OpenStack 勉強会第11回で話してきました。</p>

<p>openstack-chef-repo と言う、Opscode Chef で OpenStack を構築する内容を話して
きました。その時に説明出来なかった詳細についてブログに書いておきます。</p>

<p><iframe src="http://www.slideshare.net/slideshow/embed_code/16434817"
width="427" height="356" frameborder="0" marginwidth="0" marginheight="0"
scrolling="no" style="border:1px solid #CCC;border-width:1px 1px
0;margin-bottom:5px" allowfullscreen webkitallowfullscreen mozallowfullscreen>
</iframe> <div style="margin-bottom:5px"> <strong> <a
href="http://www.slideshare.net/tomokazubobhirai/openstack-chefrepo"
title="Openstack chef-repo" target="_blank">Openstack chef-repo</a> </strong>
from <strong><a href="http://www.slideshare.net/tomokazubobhirai"
target="_blank">Tomokazu Hirai</a></strong> </div></p>

<p>説明で使ったスライドです。</p>

<h2 id="まえがき">まえがき</h2>

<p>Essex ベースで構築することしか今は出来ません。Folsom に関しては &lsquo;直ちに開発が
スタートする&rsquo; と記されていました。今回は Opscode と RackSpace のエンジニアが共
同で開発を進めているので期待しています。今まで個人で OpenStack の各コンポーネ
ントの cookbook を開発されていた方がいらっしゃるのだけど汎用性を持たせるという
意味で非常に難しく、またどの方の開発に追従していけばよいか判断困っていました。
よって今回こそ期待。</p>

<h2 id="前提の構成">前提の構成</h2>

<pre><code>+-------------+
| chef-server |
+-------------+ 10.0.0.10
|
+---------------+ 10.0.0.0/24
|               |
+-------------+ +-------------+
| workstation | |    node     |
+-------------+ +-------------+
10.0.0.11       10.0.0.12
</code></pre>

<ul>
<li>chef-server : chef API を持つ chef-server 。cookbook, role..などのデータを持つ</li>
<li>workstation : openstack-chef-repo を使うノード。knife が使える必要がある。</li>
<li>node        : OpenStack を構築するターゲットノード</li>
</ul>

<h2 id="目次">目次</h2>

<ul>
<li>chef-server の構築 (BootStrap 使う)</li>
<li>openstack-chef-repo を使用する準備</li>
<li>openstack-chef-repo 実行</li>
</ul>

<h2 id="chef-server-の構築">chef-server の構築</h2>

<p>Opscode の wiki に記されている通りなのですが、簡単に書いておきます。今回は
bootstrap 方式で用意します。</p>

<p>chef-server ノードに chef をインストールします。chef-solo を用いるからです。</p>

<pre><code>chef-server# gem install chef
</code></pre>

<p>chef-solo を使うための設定情報を /etc/chef/solo.rb に記します。</p>

<pre><code>chef-server# mkdir /etc/chef
chef-server# ${EDITOR} /etc/chef/solo.rb
file_cache_path &quot;/tmp/chef-solo&quot;
cookbook_path &quot;/tmp/chef-solo/cookbooks&quot;
</code></pre>

<p>chef-solo を実行する際に使う json ファイルを用意します。attribute を上書きする
ことが出来ます。今回は webui を有効にした状態にします。</p>

<pre><code>chef-server# ${EDITOR} ~/chef.json
{
  &quot;chef_server&quot;: {
    &quot;server_url&quot;: &quot;http://localhost:4000&quot;,
    &quot;init_style&quot;: &quot;runit&quot;
  },
  &quot;run_list&quot;: [ &quot;recipe[chef-server::rubygems-install]&quot; ]
}
</code></pre>

<p>bootstrap して chef-server を構築します。</p>

<pre><code>chef-server# chef-solo -c /etc/chef/solo.rb -j ~/chef.json -r http://s3.amazonaws.com/chef-solo/bootstrap-latest.tar.gz
</code></pre>

<p>chef-server が完成したはずです。workstation で knife を使うために &lsquo;client&rsquo; を
作ります。chef 10.x では user ではなく client が knife を実行します。</p>

<pre><code>chef-server% mkdir ~/.chef
chef-server% sudo cp /etc/chef/validation.pem ~/.chef/
chef-server% sudo cp /etc/chef/webui.pem ~/.chef/
chef-server% sudo chown &lt;my-username&gt;:&lt;my-group&gt; ~/.chef
</code></pre>

<p>knife を使うために下記の操作を行います。</p>

<pre><code>chef-server% cd ~
chef-server% knife configure -i
Where should I put the config file? [~/.chef/knife.rb]
Please enter the chef server URL: [http://10.0.0.1:4000]
Please enter a clientname for the new client: [jedipunkz]
Please enter the existing admin clientname: [chef-webui]
Please enter the location of the existing admin client's private key:[/etc/chef/webui.pem] /home/jedipunkz/.chef/webui.pem
Please enter the validation clientname: [chef-validator]
Please enter the location of the validation key:[/etc/chef/validation.pem] /home/jedipunkz/.chef/validation.pem
Please enter the path to a chef repository (or leave blank):
Creating initial API user...
Created client[jedipunkz]
Configuration file written to /home/jedipunkz/.chef/knife.rb
</code></pre>

<p>workstaion ノードで knife を操作するための &lsquo;worker&rsquo; client を作成します。</p>

<pre><code>chef-server% export EDITOR=vim
chef-server% knife client create worker -a -f worker.pem
chef-server% knife client list
  chef-validator
  chef-webui
  chefserver.example.com
  jedipunkz
  worker
</code></pre>

<h2 id="openstack-chef-repo-を使用する準備">openstack-chef-repo を使用する準備</h2>

<p>workstation で openstack-chef-repo を使うための準備をします。</p>

<p>まずは knife を使えるように下記のように knife.rb や pem の手元への転送を行います。</p>

<pre><code>workstation% gem install chef librarian spiceweasel
workstation% cd ~
workstation% git clone git://github.com/opscode/openstack-chef-repo.git
workstation% cd openstack-chef-repo
workstation% vim .chef/knife.rb
log_level                :info
log_location             STDOUT
node_name                'worker'
client_key               '/home/jedipunkz/openstack-chef-repo/.chef/worker.pem'
validation_client_name   'chef-validator'
validation_key           '/home/jedipunkz/openstack-chef-repo/.chef/validation.pem'
chef_server_url          'http://10.0.0.10:4000'
cache_type               'BasicFile'
cache_options( :path =&gt; '/home/jedipunkz/openstack-chef-repo/.chef/checksums' )
cookbook_path           '/home/jedipunkz/openstack-chef-repo/cookbooks'
workstation% scp 10.0.0.10:~/worker.pem .chef/
workstation% scp 10.0.0.10:~/.chef/validation.pem .chef/
</code></pre>

<p>librarian を使って OpenStack 構築に必要な cookbooks をダンロードします。Cheffile
というファイルに何をどこから取得するのか記されいてそれにしたがってダウンロードされます。</p>

<pre><code>workstation% libratrian-chef update
</code></pre>

<p>環境に合わせて production.yml を修正します。今回必要最低限の箇所のみ修正します。
&ldquo;osops_networks&rdquo; という箇所に nova-network に渡すネットワーク情報があるので今回の
環境 10.0.0.0/24 に修正します。全体はこのような内容になります。</p>

<pre><code>workstation% ${EDITOR} production.yml
name &quot;production&quot;
description &quot;Defines the network and database settings you're going to use with OpenStack. The networks will be used in the libraries provided by the osops-utils cookbook. This example is for FlatDHCP with 2 physical networks.&quot;

override_attributes(
  &quot;glance&quot; =&gt; {
    &quot;image_upload&quot; =&gt; true,
    &quot;images&quot; =&gt; [&quot;precise&quot;,&quot;cirros&quot;],
  },
  &quot;mysql&quot; =&gt; {
    &quot;allow_remote_root&quot; =&gt; true,
    &quot;root_network_acl&quot; =&gt; &quot;%&quot;
  },
  &quot;osops_networks&quot; =&gt; {
    &quot;public&quot; =&gt; &quot;10.0.0.0/24&quot;,
    &quot;management&quot; =&gt; &quot;10.0.0.0/24&quot;,
    &quot;nova&quot; =&gt; &quot;10.0.0.0/24&quot;
  },
  &quot;nova&quot; =&gt; {
    &quot;network&quot; =&gt; {
      &quot;fixed_range&quot; =&gt; &quot;192.168.100.0/24&quot;,
      &quot;public_interface&quot; =&gt; &quot;eth0&quot;
    },
    &quot;networks&quot; =&gt; [
      {
        &quot;label&quot; =&gt; &quot;public&quot;,
        &quot;ipv4_cidr&quot; =&gt; &quot;192.168.100.0/24&quot;,
        &quot;num_networks&quot; =&gt; &quot;1&quot;,
        &quot;network_size&quot; =&gt; &quot;255&quot;,
        &quot;bridge&quot; =&gt; &quot;br100&quot;,
        &quot;bridge_dev&quot; =&gt; &quot;eth0&quot;,
        &quot;dns1&quot; =&gt; &quot;8.8.8.8&quot;,
        &quot;dns2&quot; =&gt; &quot;8.8.4.4&quot;
      }
    ]
  }
  )  
</code></pre>

<p>infrastructure.yml という spiceweasel が参照するファイルの修正を行います。
cookbooks, roles, environments, data bags, node とパラメータがあり node
のみ記されていないので今回用意したターゲットノードの情報を追記します。</p>

<p>node には予め SSH 公開鍵を設置する必要があります。また下記は root ユーザでログ
インしていますが、sudo してもらっても構わないです。role で指定した &lsquo;allinone&rsquo;
は OpenStack の全てのコンポーネントを一台のノードにインストールするためのもの
です。これを他の role 例えば &lsquo;keystone&rsquo; 等を指定して複数のノードに OpenStack
を展開することも可能なはずです。試していませんが。</p>

<pre><code>workstation% vim infrastructure.yml
... 省略
nodes:
- 10.0.0.12:
  run_list: role[allinone]
  options: -i ~/.ssh/id_rsa -x root -E production
</code></pre>

<h2 id="openstack-chef-repo-実行">openstack-chef-repo 実行</h2>

<p>準備が整ったので spiceweasel を使って knife コマンドの出力チェックと実行をして
みます。先ほど追記した infrastructure.yml を使います。</p>

<pre><code>workstation% spiceweasel infrastructure.yml
knife cookbook upload apache2
knife cookbook upload apt
knife cookbook upload aws
knife cookbook upload build-essential
knife cookbook upload ntp
knife cookbook upload openssh
knife cookbook upload openssl
knife cookbook upload postgresql
knife cookbook upload selinux
knife cookbook upload xfs
knife cookbook upload yum
knife cookbook upload erlang
knife cookbook upload mysql
knife cookbook upload rabbitmq
knife cookbook upload database
knife cookbook upload omnibus_updater
knife cookbook upload lxc
knife cookbook upload sysctl
knife cookbook upload osops-utils
knife cookbook upload mysql-openstack
knife cookbook upload rabbitmq-openstack
knife cookbook upload keystone
knife cookbook upload glance
knife cookbook upload nova
knife cookbook upload horizon
knife environment from file production.rb
knife role from file base.rb
knife role from file lxc.rb
knife role from file mysql-master.rb
knife role from file rabbitmq-server.rb
knife role from file keystone.rb
knife role from file glance-api.rb
knife role from file glance-registry.rb
knife role from file glance.rb
knife role from file nova-setup.rb
knife role from file nova-scheduler.rb
knife role from file nova-api-ec2.rb
knife role from file nova-api-os-compute.rb
knife role from file nova-volume.rb
knife role from file nova-vncproxy.rb
knife role from file horizon-server.rb
knife role from file single-controller.rb
knife role from file single-compute.rb
knife role from file allinone.rb
knife bootstrap 10.0.0.12 -i ~/.ssh/id_rsa -x root -E production -r 'role[allinone]'  
</code></pre>

<p>この操作で spiceweasel は role ファイルの中身と yml ファイルを読み、依存関係を
チェックしてくれます。</p>

<p>ではいよいよ実行。</p>

<pre><code>workstaion% spiceweasel -e infrastructure.yml
</code></pre>

<p>数分で OpenStack 環境が構築出来ると思います。</p>

<h2 id="所感">所感</h2>

<p>現時点ではまだ essex ベースの OpenStack しか構築出来ない。folsom 以降について
は直ちに行われる。また先にも記したが Opscode と RackSpace のエンジニアが共同で
作業に入ったので今後に期待。複数の OpenStack cookboooks を見てきたが個人で開発
するのは厳しいと感じています。fedra, centos, ubuntu, debian &hellip; いろんなプラッ
トフォームを前提に開発するのは厳しい&hellip;。pull request する余力があればやってみ
たい。また合わせて各コンポーネントの cookbooks についても同様に参加していきた
い。</p>

<p>chef は繰り返し実行されるので継続的にデプロイが可能であり、chef Resources が我々
の操作を抽象化してくれる。尚且つ API で開発も容易になる。学習コストは若干高い
し、cookbooks の開発も正直しんどい。だけどインフラを chef でコントロールする意
味はとても大きい。その他のメリットとして属人的な操作に依存したシステムを無くす
という事もある。</p>

<p>OpenStack のドキュメントにはデプロイ方法として dodai-deploy と puppet が掲載さ
れている。chef は載っていない。これは cookbooks の開発が遅れている状況が理由に
あると思う。今回 Opscode の中の Matt Ray さんの下記の資料</p>

<p><a href="http://www.slideshare.net/mattray/chef-11-previewchef-for-openstack">http://www.slideshare.net/mattray/chef-11-previewchef-for-openstack</a></p>

<p>を見て、これからに期待したいと感じた。</p>
</p>

    <footer>
        <ul class="actions">
            <li><a href="https://jedipunkz.github.io/blog/2013/02/10/di-11hui-openstack-study11-openstack-chef-repo/" class="button big">Continue Reading</a></li>
        </ul>
        <ul class="stats">
    
        

        
        
            <li>
                
                
                    

                    
                        Categories
                    
                
            </li>
        
    

    
    
        <li><a href='/categories/infrastructure'>infrastructure</a></li>
    
        <li><a href='/categories/report'>report</a></li>
    
</ul>

    </footer>
</article>


        
            <article class="post">
    <header>
    <div class="title">
        
            <h2><a href="https://jedipunkz.github.io/blog/2012/10/06/secret-training-of-opscode-chef/">Secret Training of Opscode Chef</a></h2>
        
        
    </div>
    <div class="meta">
        
            
        

        <time class="published"
            datetime='2012-10-06'>
            October 6, 2012</time>
        <span class="author"></span>
        
        
    </div>
</header>

    

    
    <p><p>昨日、開かれた &ldquo;Opscode Chef のシークレットトレーニング&rdquo; に参加してきました。</p>

<p>場所はうちの会社で KDDI ウェブコミュニケーションズ。主催はクリエーションオンラ
インさんでした。講師は Sean OMeara (@someara) さん。今後 Chef のトレーニングを
日本で開くため、事前に内容についてフィードバックが欲しかったそうで、オープンな
レッスンではありませんでしたが、次回以降、日本でも期待できそうです。</p>

<p>内容は chef の基本・メリット・考え方などを網羅した資料で1時間程進められ、その
後はハンズオンがメインでした。今日は実際にハンズオンの内容を書いていこうかと思
います。</p>

<p>chef workstation 環境は揃っている前提にします。また chef server として opscode
の hosted chef (opscode が提供している chef のホスティングサービス,
chef-server として動作します) を使います。またターゲットホストは当日は ec2 イ
ンスタンスを使いましたが、chef ワークステーションから到達できるホストであれば
何でも良いでしょう。</p>

<p>まずは chef-repo のクローン。講習会で使われたものです。</p>

<pre><code>git clone https://github.com/opscode/chef-repo-workshop-sysadmin.git chef-repo
</code></pre>

<p>予め cookbook が入っています。</p>

<p>次に、manage.opscode.com へアクセスしアカウントを作ります。Free アカウントが誰
でも作れるようになっています。</p>

<p><a href="https://manage.opscode.com">https://manage.opscode.com</a> へアクセス -&gt; Sign Up をクリック -&gt; アカウント情報
を入力 -&gt; submit -&gt; メールにて verify -&gt; 自分のアカウント名をクリック -&gt; Get a
new key をクリックし &lt;アカウント名&gt;.pem をダウンロード -&gt; create a
organization をクリックし Free を選択し、適当な名前で organization を作成。
validation key と knife.rb をダウンロード</p>

<p>これらで得た3つのファイル (2つの pem とknife.rb) を chef-repo/.chef/ 配下に置
きます。これで準備 OK。knife.rb を見ると、opscode の chef ホスティングにアクセ
スするよう記述があります。</p>

<pre><code>% cp &lt;somewhere&gt;/knife.rb &lt;somewhere&gt;/&lt;account&gt;.pem &lt;somewhere&gt;/&lt;account&gt;-validation.pem chef-repo/.chef/
</code></pre>

<p>トレーニング用 chef-repo には予め幾つかの cookbook と role, data_bag が入って
います。これらを knife を使ってアップロードします。</p>

<pre><code>% cd chef-repo
% knife cookbook upload -a
% knife role from file role/*.rb
% knife data bag create users
% knife data bag from file users nagiosadmin.json
</code></pre>

<p>そして bootstrap を実行。.chef/bootstrap ディレクトリに chef-full.erb ファイル
が入っていて bash スクリプトになっている。knife bootstrap でこの bash スクリプ
トをターゲットホスト上で実行することになる。中身はと言うと chef 環境をインストー
ルしているようだ。</p>

<p>chef 環境をどうやってノードに入れているかなぁ。preseed 使うかな。手作業じゃ意
味ないしなぁと考えていたのですが、こうやればいいのですね。参考になります。これ
は簡単。</p>

<p>ではいよいよ bootstrap を実行。</p>

<pre><code>% knife bootstrap &lt;IPADDRESS&gt; -r 'role[base],role[monitoring]' --sudo -x &lt;USER&gt; -P &lt;PASSWD&gt;
</code></pre>

<p>IP アドレス、ssh ユーザ名・パスワードは適宜入れてください。これで cookbooks ディ
レクトリ配下の各種 cookbook が実行されました。中身は nagios とそれに依存する
apache2, openssl, mysql, php 等。</p>

<p>次に cookbook を新たにダウンロードし knife upload してみます。</p>

<pre><code>% knife cookbook site download chef-client
% tar zxvf chef-client-1.2.0.tar.gz -C cookbooks/
% knife cookbook upload chef-client
</code></pre>

<p>「アカウントの pem がない場合 validation が用いられるが、一旦サーバと通信出来た
ら validation は必要なくなる。それどころか wi-fi パスワードのようなものなので
validation は削除することを強くすすめる」と Sean が言っていました。chef 環境は
すでに bootstrap で入っているものの、validation を削除するための recipe を
base という role に追加し、実行してみます。</p>

<p>Sean の言っていたこと、間違っていたら指摘してください( &gt;&lt; ) 英語だったので自信
ないです。</p>

<pre><code>% vim role/base.rb
name &quot;base&quot;
description &quot;Base role applied to all nodes.&quot;
run_list(
  &quot;recipe[apt]&quot;,
  &quot;recipe[nagios::client]&quot;
  &quot;recipe[chef-client::delete_validation]&quot;
)

default_attributes(
  &quot;nagios&quot; =&gt; {
  &quot;server_role&quot; =&gt; &quot;monitoring&quot;
  }
)
</code></pre>

<p>role をアップロード。</p>

<pre><code>% knife role from file roles/base.rb
</code></pre>

<p>ターゲットホストで chef-client を実行。ここで バージョン 10.14 から登場した
why-run を試してから実行。</p>

<pre><code>target# chef-client -Fdoc -lfatal --color --why-run
target# chef-client -Fdoc -lfatal --color
</code></pre>

<p>もしくはワークステーションから knife ssh を使っても良い。</p>

<pre><code>% knife search node &quot;role:base&quot; -a cloud.public_ipv4
% knife ssh &quot;role:base&quot; &quot;sudo chef-client -Fmin&quot; -x ubuntu -P opscodechef -a cloud.public_ipv4
</code></pre>

<p>-a cloud.public_ipv4 とは、AWS EC2 や OpenStack, CloudStack 環境ではインスタン
スの eth0 インターフェースにプライベート IP アドレスが付与されているケースが
殆どなため、グローバル IP アドレスを検索し実行している。</p>

<p>大きな流れはこれでおしまい。</p>

<p>トレーニングでは bento, minitest, cucumber-chef 等の紹介があったが、詳細な内容
については見送られた。昼休み1時間をはさんで計7時間の長丁場だったが、chef 初級
を脱するのには最適なトレーニングだった。これからトレーニング内容や種別を組んで
いくそうなので、内容は変わってくるかもしれない。あとでフィードバックをしなく
ちゃ。</p>

<p>個人的には OpenStack に興味を持っているので chef を使って OpenStack をデプロイ
したい。今年6月には &lsquo;Chef for OpenStack&rsquo; というアナウンスがあり、DELL,
RackSpace, HP 等の大企業がパートナーとして参加することになったと発表があった。
今まで openstack cookbook は長くメンテナンスされてこなかったので、これには期待
している。</p>

<p>最後にこの機会を作って下さった クリエーションオンラインさん、opscode の Sean
さん、mr.devops さん、ありがとうございましたー。貴重な体験でした。</p>
</p>

    <footer>
        <ul class="actions">
            <li><a href="https://jedipunkz.github.io/blog/2012/10/06/secret-training-of-opscode-chef/" class="button big">Continue Reading</a></li>
        </ul>
        <ul class="stats">
    
        

        
        
            <li>
                
                
                    

                    
                        Categories
                    
                
            </li>
        
    

    
    
        <li><a href='/categories/infrastructure'>infrastructure</a></li>
    
        <li><a href='/categories/report'>report</a></li>
    
</ul>

    </footer>
</article>


        
            <article class="post">
    <header>
    <div class="title">
        
            <h2><a href="https://jedipunkz.github.io/blog/2012/08/29/7th-openstack-meetup/">第7回 OpenStack 勉強会参加レポート</a></h2>
        
        
    </div>
    <div class="meta">
        
            
        

        <time class="published"
            datetime='2012-08-29'>
            August 29, 2012</time>
        <span class="author"></span>
        
        
    </div>
</header>

    

    
    <p><p>第7回 OpenStack 勉強会に参加してきました。</p>

<pre><code>開催日   : 2012年08月28日
開催場所 : 天王洲アイル ビットアイル
</code></pre>

<p>1年以上前から OpenStack, CloudStack 界隈はウォッチしていたのだけど、実際に構築
してってなると、今月始めばかりで、OpenStack も先週4日間掛けてやっとこさ構築出来たっ
てところ&hellip;orz。前回のブログ記事でへなちょこスクリプト公開しちゃったのを後悔しつ
つ現地に向かいましたw あと、その他に Opscode Chef 等の技術にも興味持って調査し
ていたので、今回の勉強会はまさに直ぐに活かせる内容だった。</p>

<p>では早速、報告があった内容と自分の感想を交えつつ書いていきます。</p>

<h2 id="hp-さんのクラウドサービス-hp-cloud-services">HP さんのクラウドサービス HP Cloud Services</h2>

<pre><code>日本 HP 真壁さま
</code></pre>

<p>HP さんは既に Public クラウドサービスを提供し始めていて Ojbect Storage, CDN 部
分は既にリリース済みだそうだ。compute, block storage 等はベータ版状態でこれか
らリリース。OpenStack ベースな構成で Horizon 部分は自前で開発したもの。既
にサーバ数は万の桁まで到達！ MySQL な DaaS も登場予定だとか。</p>

<p>あと HP だけにクラウドサービスに特化したサーバ機器も出していて、それが HP
Project Moonshot 。ARM/Atom 搭載のサーバで 2,880 nodes/rack が可能だとか！す
げぇ。もちろん電源等のボトルネックとなるリソースは他にも出てきそうだけど。</p>

<p>ノード数って増えると嬉しいのかな？コア数が増えるのは嬉しいけど。</p>

<h2 id="canonical-juju">Canonical JuJu</h2>

<pre><code>Canonical 松本さま
</code></pre>

<p>JuJu は Canonical が提供しているデプロイツールで charms と呼ばれるレシピ集 (っ
て言うと語弊があるのか) に従ってソフトウェアの配布を行うツール。MAAS という物
理サーバのプロビジョニングツールと組み合わせればハードウェアを設置した後のプロ
ビジョニング操作は一気通貫出来る、といったもの。具体的な操作例を挙げてくれたの
で添付してきます。</p>

<pre><code>% juju deploy --repository=/tmp swift-proxy
% juju deploy --repository=/tmp swift-storage
% juju add-relation swift-storage:swift-proxy
% swift-proxy:swift-proxy
% juju add-unit swift-storage # node 追加
</code></pre>

<p>swift-proxy, swift-storage をデプロイし、その後それぞれを関係付けているのが
add-relation。また swift-proxy に対して swift-storage node を追加してくといっ
た操作が add-unit らしい。</p>

<p>Charms と呼ばれるモノの中をのぞかせてもらったが Shell Script と json ファイル
集になっていた。インフラ系のエンジニアに操作してもらうにはこれがベスト、といっ
たところなのだろう。Opscode Chef の様な自由度があるかどうかは、触ってみないと
分からない。時間を見つけて調べてみるかぁ。</p>

<p>ちなにみ今日 MAAS について調べたのですが、これは PXE Boot と DHCP のコンフィギュ
レーションを GUI でするってものなのですね。後に出てくる Crowbar とはだいぶ違う。
間違っていたら指摘してください..。</p>

<p>参考 URL : <a href="https://wiki.ubuntu.com/ServerTeam/MAAS">https://wiki.ubuntu.com/ServerTeam/MAAS</a></p>

<h2 id="redhat-の-openstack-への取り組み">RedHat の OpenStack への取り組み</h2>

<pre><code>RedHat 中井さま
</code></pre>

<p>OpenStack ディストリビューションを提供し始めたことで最近話題になっていたが、い
よいよ今年2012年10月リリース予定の folsom をベースとしたリリースを2013年に控え
ているそうだ。ここで初めて有償サポートが開始されるそう。より簡単に構築が出来て、
技術的な不安定を持っているユーザを取り込んでいくのだろう。面白いネタも貰えた。
将来、Swift 代替で Gluster-FS が扱えるようになる可能性があるそうだ。また KVM
にコミットしているエンジニアを抱えている彼らだが、KVM から直接 Gluster-FS 上の
VM イメージを操作出来るように修正加える案も出ているそうだ。これが実現すれば、
nova ノードのサーバリソースに依存しない大きな Disk イメージを扱うことも可能に
なるだろう。</p>

<p>また、Canonical JuJu, Opscode Chef に並ぶツールの紹介もあった。CloudForms がそ
れなのだが、各社と共通するコンセプトを持っているようだ。開発環境・本番環境への
シームレスなデプロイ、と。</p>

<h2 id="dell-crowbar">DELL Crowbar</h2>

<pre><code>DELL 増月さま
</code></pre>

<p>ある意味、僕にとって一番の収穫だったのが DELL の Crowbar。DELL サーバに依存せ
ず使えるデプロイツールで、IPMI, RAID, BIOS 等のハードウェア構成も自動構築が出
来るそう！また Opscode Chef がベースになっていて barclamp と呼ばれる Chef で
言う Cookbooks を元にソフトウェアをデプロイしていくそうだ。Chef Server 環境が
必須で chef-solo のような操作には対応していなそうなのが残念だった。Web ベース
の GUI インターフェースで操作するらしい。デモも当日見れました。</p>

<p>ハードウェア構成も自動構築出来るツールは Canonical の MAAS があるが、一歩踏み
込んだ構成が組めそう。尚、Opscode の Cookbooks を再利用するのは少し難しい状況
のようだ。この辺りは 2.0 バージョンで改善されるそうだ。Chef との依存関係をより
シンプルなものにするそう。</p>

<p>他ベンダのと差別化を図るのかと思いきや、サーバ機器に依存しないツールを出してく
る DELL さんの思いは、どこにあるのだろう。あと BIOS, RAID 周りをソフトウェアで
プロビジョニングしていく受け口の I/F は IPMI なのかな？質問すればよかった。</p>

<h2 id="gmo-お名前-kvm">GMO お名前 KVM</h2>

<p>先月の OSC で発表になった資料をベースに説明して頂いた。diablo ベースで CentOS
上に構築されているらしい。また griddynamic.net のパッケージ (知らなかった) を
利用して (なぜ素直に Ubuntu 使わないのかな？) 構築したそうだ。griddynamic.net
のパッケージは既にエキスパイアしているらしい&hellip;。nova ノードは既に200台規模。
libvirt, kvm 周りにパッチを独自で当てているそうで、その具体的内容が聞けた。た
だこの辺は OpenStack のアップデートに追いつく作業がめちゃ大変になるだろうなぁ
と想像する。..</p>

<h2 id="全体を通して">全体を通して</h2>

<p>Opscode Chef に並ぶ技術が出始めてきた。OpenStack で nodes を追加するところまで
自動化したとしても vm 上の操作を手作業するわけにはいかないし、必然なのだろう。
よりディストリビューションに依存しない、インフラ系・アプリ系共に理解出来る、自
由度のある、汎用性のある技術を我々が選びながら使っていく必要がありそう。僕らイ
ンフラ系エンジニアの仕事内容も、この辺りにシフトしていく時代はもう目の前まで来
ているだろう。OpenStack を構築する手順が JuJu 等でコマンド一発なのを見て唖然と
したのも確か。誰でもできる操作になるのも必然で、ただどういう操作がされているか
を理解し、必要に応じて改変して開発していく力は身に着けておかないと、インフラ系
は特に、仕事内容が単純化していく一方になる気がする。危機を感じつつチャンスに結
びつけるいい機会なのかなぁ。あとは監視周りも自動コンフィギュレーションされない
と、真の自動化には至らないなぁ。</p>

<p>当日は BitIsle スタッフのみなさん、コミュニティのみなさん、ありがとうございま
したぁー。</p>
</p>

    <footer>
        <ul class="actions">
            <li><a href="https://jedipunkz.github.io/blog/2012/08/29/7th-openstack-meetup/" class="button big">Continue Reading</a></li>
        </ul>
        <ul class="stats">
    
        

        
        
            <li>
                
                
                    

                    
                        Categories
                    
                
            </li>
        
    

    
    
        <li><a href='/categories/infrastructure'>infrastructure</a></li>
    
        <li><a href='/categories/report'>report</a></li>
    
</ul>

    </footer>
</article>


        
            <article class="post">
    <header>
    <div class="title">
        
            <h2><a href="https://jedipunkz.github.io/blog/2012/03/07/heroku-jp-meetup-number-3/">Heroku JP Meetup #3</a></h2>
        
        
    </div>
    <div class="meta">
        
            
        

        <time class="published"
            datetime='2012-03-07'>
            March 7, 2012</time>
        <span class="author"></span>
        
        
    </div>
</header>

    

    
    <p><p>白金台のクックパッドさんで行われた &ldquo;heroku jp meet up #3&rdquo; に参加してきました。</p>

<p>東京マラソン参加のため来日されていた <a href="http://twitter.com/stolt45">Christopher Stolt</a> さんや Ruby コミッタの<a href="http://twitter.com/ayumin">相澤</a>さんなどの話を聞けました。</p>

<p>Christopher さんからは、基本的な使い方や heroku で動作させたアプリケーションをローカル環境で動作させる foreman、また皆が意外と気にするアプリのログを tail する方法などの説明がありました。PaaS での皆の懸念点が結構解決されたんじゃないかなぁ。</p>

<p>相澤さんからは NY マラソンでの実績など、比較的エンタープライズな使われ方もされ初めていると説明がありました。あと、呼び名なのですが heroku は &ldquo;へろく&rdquo; と発音するそうです。確かに about.heroku.com には &ldquo;Heroku (pronounced her-OH-koo) is a cloud application platform&rdquo; と書いてあるのだが、&rdquo;へろく&rdquo; が正しいそうです。w</p>

<p>そのた LT が幾つあって、ちょうど気になっていた <a href="http://lokka.org/">Lokka</a> の話があったので、自宅に帰ってから自分の heroku アカウントで lokka を動かしてみました。lokka の公式サイトに手順が書いてあって、そのままなのですが行ったのは、</p>

<pre><code>% gem install heroku bundler
% git clone git://github.com/komagata/lokka.git
% cd lokka
% heroku create
% git push heroku master
% heroku rake db:setup
% heroku open
</code></pre>

<p>すれば OK。</p>

<p>私の環境では公開鍵認証がうまくいかなかったので、下記の対処をしました。</p>

<pre><code>% heroku keys:add
</code></pre>

<p>試しに wordpress のデータを移行してみようと思ったのですが、&rdquo;Application Error&rdquo; が発生。今のところうまくいっていません。コードとブログコンテンツを git で管理出来るので、今時ですよね。初めてみたい。</p>

<p>また、今回会場を提供してくださったクックパッドさんが、バレンタインデーということもあり皆に料理を提供して下さいました。感謝ー。</p>

<p>本当は heroku システムがどう構成されているか？が知りたかったのですが、ユーザ視点で使われ方が分からないと何も出来ないと感じていたため、今回はとても良い機会でした。個人的にも heroku は使い続けたい、と感じたサービスでした。みなさん、当日はありがとうございました。</p>
</p>

    <footer>
        <ul class="actions">
            <li><a href="https://jedipunkz.github.io/blog/2012/03/07/heroku-jp-meetup-number-3/" class="button big">Continue Reading</a></li>
        </ul>
        <ul class="stats">
    
        

        
        
            <li>
                
                
                    

                    
                        Category
                    
                
            </li>
        
    

    
    
        <li><a href='/categories/report'>report</a></li>
    
</ul>

    </footer>
</article>


        

        
<ul class="actions pagination">
    
        <li><a href="#" class="disabled button big previous">Previous Page</a></li>
    

    
        <li><a href="#" class="disabled button big next">Next Page</a></li>
    
</ul>

    </div>
    
<section id="sidebar">

    
        <section id="intro">
            
            
            
            <ul class="icons">
                
                    <li><a href="https://jedipunkz.github.io/categories/report/index.xml" type="application/rss+xml"
                        target="_blank" title="RSS" class="fa fa-rss"></a></li>
                
                
            </ul>
        </section>

    
        <section id="recent-posts">
            <ul class="posts">
                <header>
                    <h3>Recent Posts</h3>
                </header>
                
                    
                

                
                    
                

                
                    <li>
                        <article>
                            <header>
                                <h3><a href="https://jedipunkz.github.io/blog/2018/12/31/istio/">Istio, Helm を使って Getting Started 的なアプリをデプロイ</a></h3>
                                
                                    
                                
                                <time class="published" datetime=
                                    '2018-12-31'>
                                    December 31, 2018</time>
                            </header>
                        </article>
                    </li>
                
                    <li>
                        <article>
                            <header>
                                <h3><a href="https://jedipunkz.github.io/blog/2017/07/02/test-kitchen-cluster/">Docker,Test-Kitchen,Ansible でクラスタを構成する</a></h3>
                                
                                    
                                
                                <time class="published" datetime=
                                    '2017-07-02'>
                                    July 2, 2017</time>
                            </header>
                        </article>
                    </li>
                
                    <li>
                        <article>
                            <header>
                                <h3><a href="https://jedipunkz.github.io/blog/2017/04/13/gke-lb/">GCP ロードバランサと GKE クラスタを Terraform を使って構築する</a></h3>
                                
                                    
                                
                                <time class="published" datetime=
                                    '2017-04-13'>
                                    April 13, 2017</time>
                            </header>
                        </article>
                    </li>
                
                    <li>
                        <article>
                            <header>
                                <h3><a href="https://jedipunkz.github.io/blog/2017/02/12/serverless-fission/">Serverless on Kubernetes : Fission を使ってみた</a></h3>
                                
                                    
                                
                                <time class="published" datetime=
                                    '2017-02-12'>
                                    February 12, 2017</time>
                            </header>
                        </article>
                    </li>
                
                    <li>
                        <article>
                            <header>
                                <h3><a href="https://jedipunkz.github.io/blog/2017/01/13/kubernetes-deployments/">Kubernetes Deployments を使ってみた！</a></h3>
                                
                                    
                                
                                <time class="published" datetime=
                                    '2017-01-13'>
                                    January 13, 2017</time>
                            </header>
                        </article>
                    </li>
                

                
                    <li>
                        <ul class="actions">
                            <li><a href=
                            
                                "/post/"
                            
                            class="button">View more posts</a></li>
                        </ul>
                    </li>
                
            </ul>
        </section>

    
    
    
    
        <section id="categories">
            <ul class="posts">
                <header>
                    <h3><a href="/categories/">Categories</a></h3>
                </header>

                
                    
                

                
                    <li>
                        <article>
                            <header>
                                <a href="/categories/infrastructure/">infrastructure</a>
                                <span style="float:right;">110</span>
                            </header>
                        </article>
                    </li>
                
                    <li>
                        <article>
                            <header>
                                <a href="/categories/report/">report</a>
                                <span style="float:right;">9</span>
                            </header>
                        </article>
                    </li>
                
                    <li>
                        <article>
                            <header>
                                <a href="/categories/tools/">tools</a>
                                <span style="float:right;">11</span>
                            </header>
                        </article>
                    </li>
                
            </ul>
        </section>
    

    
        

    
        <section id="footer">
            <ul class="icons">
                
                    <li><a href="https://jedipunkz.github.io/categories/report/index.xml" type="application/rss+xml"
                        target="_blank" title="RSS" class="fa fa-rss"></a></li>
                
                
            </ul>

            <p class="copyright">&copy; ジェダイさんのブログ. テーマデザインは <a href="//github.com/jpescador" target="_blank">Julio Pescador</a>さんによるものです。 </p>
        </section>

</section>

            </div>
        <a id="back-to-top" href="#" class="fa fa-arrow-up fa-border fa-2x"></a>
        

        
        
            
        

        
        
            <script src="/js/jquery.min.js"></script>
            <script src="/js/skel.min.js"></script>
            <script src="/js/util.js"></script>
            <script src="/js/main.js"></script>
            <script src="/js/backToTop.js"></script>
            <script src="/js/highlight.pack.js"></script>
        

        

            
            <script>hljs.initHighlightingOnLoad();</script>
            
    </body>
</html>

